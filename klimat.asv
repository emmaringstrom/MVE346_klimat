
%% Uppgift 1.1
clc, clear, clf

%Parametrar
F = [0 60 0; 15 0 45; 45 0 0]; %GtC
NPP0 = F(1,2);
beta = 0.35; %Kan variera mellan 0.1 och 0.8
B0 = [600 600 1500]; %GtC
global CO2Emissions;
global CO2ConcRCP45;

%Nettoprimärproduktion av biomassa (fotosyntes)
NPP = @(B1) NPP0*(1+beta*log(B1/B0(1)));

%Flödeskoefficienter
alpha = @(i,j) F(i,j)/B0(i);

%Differentialekvationer
dB1 = @(B,t) alpha(3,1)*B(3,:) + alpha(2,1)*B(2,:) - NPP(B(1,:)) + CO2Emissions(t);
dB2 = @(B,t) NPP(B(1,:)) - alpha(2,3)*B(2,:) - alpha(2,1)*B(2,:);
dB3 = @(B,t) alpha(2,3)*B(2,:) - alpha(3,1)*B(3,:);

dB = @(B,t) [dB1(B,t); dB2(B,t); dB3(B,t)];

%Lösning
B = eulerforward(B0, dB);

%Koncentrationerna
conc = 0.469 * B(1,:); %ppm C02

%Plot
t = 1765:2500;
plot(t,conc,'m')
hold on
plot(t,CO2ConcRCP45,'g')
legend('Our estimation','RCP 4.5','Location','northwest')
xlabel('Year'), ylabel('CO_2 concentration (ppm)')


%% Uppgift 1.2

clc, clear, clf

%Parametrar
F = [0 60 0; 15 0 45; 45 0 0]; %GtC
NPP0 = F(1,2);
beta = linspace(0.1,0.8,5);
B0 = [600 600 1500]; %GtC
global CO2Emissions;
global CO2ConcRCP45;

col = ['m','g','b','r','c'];

for b = 1:length(beta)

    %Nettoprimärproduktion av biomassa (fotosyntes)
    NPP = @(B1) NPP0*(1+beta(b)*log(B1/B0(1)));

    %Flödeskoefficienter
    alpha = @(i,j) F(i,j)/B0(i);

    %Differentialekvationer
    dB1 = @(B,t) alpha(3,1)*B(3,:) + alpha(2,1)*B(2,:) - NPP(B(1,:)) + CO2Emissions(t);
    dB2 = @(B,t) NPP(B(1,:)) - alpha(2,3)*B(2,:) - alpha(2,1)*B(2,:);
    dB3 = @(B,t) alpha(2,3)*B(2,:) - alpha(3,1)*B(3,:);

    dB = @(B,t) [dB1(B,t); dB2(B,t); dB3(B,t)];

    %Lösning
    B = eulerforward(B0, dB);

    %Koncentrationerna
    conc = 0.469 * B(2,:); %ppm C02

    %Plot
    t = 1765:2500;
    txt = ['beta = ',num2str(beta(b))];
    plot(t,conc,col(b),'DisplayName',txt)
    hold on

end

hold off
legend('Location','northwest')
xlabel('Year'), ylabel('CO_2 concentration (ppm)')


%% Uppgift 1.3

clc, clear, clf

%Parametrar
A = [0.113 0.213 0.258 0.273 0.1430];
tao_0 = [2.0 12.2 50.4 243.3 Inf];
k = 3.06*1e-3;
n = length(A);

%Tidskonstant
tao = @(U) tao_0*(1 + k*U);

%Impulssvaret
imp = @(t, tao) sum(A' .* exp(-t./tao'));

t = 0:500;
U = [0, 140, 560, 1680];

for u = U
    I = imp(t, tao(u));
    plot(t, I), hold on
end

legend('U = 0','U = 140','U = 560','U = 1680')
xlabel('Year'), ylabel('Impulse response')

%% Uppgift 1.4
clc, clear, clf

%Parametrar
A = [0.113 0.213 0.258 0.273 0.1430];
tao_0 = [2.0 12.2 50.4 243.3 Inf];
k = 3.06*1e-3;
M0 = 600;
global CO2Emissions;
global CO2ConcRCP45;

U = CO2Emissions;

T = 1:length(U);

tao = @(t_hat) tao_0 .* (1 + k * sum(U(1:t_hat)))';  % ha inte med årets utsläpp
I = @(t, t_hat) sum(A' .* exp(-t./tao(t_hat)'));
M = M0 * ones(1, length(U));
for t = T
    for delta_t = t:-1:1
        M(t) = M(t) + I(t-delta_t, t) * U(delta_t);
    end
end
conc = 0.469 * M;

years = 1765:2500;
plot(years,conc,'DisplayName','Our model');
hold on
axis([1700 2500 0 700])
plot(years,CO2ConcRCP45(1:length(T)),'DisplayName','RCP4.5');
legend('Location','southeast')
xlabel('Year'), ylabel('CO_2 concentration (ppm)')


%% Uppgift 1.6
clc, clear, clf

%Parametrar
F = [0 60 0; 15 0 45; 45 0 0]; %GtC
NPP0 = F(1,2);
% beta = 0.38; %Kan variera mellan 0.1 och 0.8
B0 = [600 600 1500]; %GtC
A = [0.113 0.213 0.258 0.273 0.1430];
tao_0 = [2.0 12.2 50.4 243.3 Inf];
k = 3.06*1e-3;
M0 = 600;
global CO2Emissions;
global CO2ConcRCP45;

for beta = [0.35 0.28] %[0.38 0.34]
    
    NPP = @(B) NPP0*(1+beta*log(B(1)/B0(1)));

    %Flödeskoefficienter
    alpha = @(i,j) F(i,j)/B0(i);

    % Differentialekvationer
    % B är en 1x3 vektor
    dB1 = @(B,t) alpha(3,1)*B(3) + alpha(2,1)*B(2) - NPP(B) + CO2Emissions(t);
    dB2 = @(B,t) NPP(B) - alpha(2,3)*B(2) - alpha(2,1)*B(2);
    dB3 = @(B,t) alpha(2,3)*B(2) - alpha(3,1)*B(3);
    dB = @(B,t) [dB1(B,t); dB2(B,t); dB3(B,t)];

    % -- lösning --
    B = zeros(3, length(CO2Emissions));    % 3 x 736 matris för alla B
    B(:, 1) = B0(:);    % sätt startvärden
    emissions = zeros(1, length(CO2Emissions));
    for t = 1:length(CO2Emissions)-1   % 1:735
        M = M0;
        for t_tilde = 1:t                
            I = sum(A' .* exp(-(t-t_tilde) ./ (tao_0*(1+k*emissions(t)))'));
            M = M + I * dB1(B(:, t_tilde), t_tilde);
        end
      
        B(:, t+1) = B(:, t) + dB(B(:, t), t);
        
        % kumulativa utsläpp (utan haven)
        emissions(t+1) = emissions(t) + dB1(B(:, t), t);
        
        % B1 med haven
        B(1, t+1) = M;
    end
    
    % Koncentrationerna
    conc = 0.469 * B(1,:); %ppm C02

    % Plot
    t = 1765:2500;
    plot(t,conc, 'DisplayName', ['\beta = ',num2str(beta)])
    hold on
end
axis([1700 2500 0 600])
plot(t,CO2ConcRCP45, 'DisplayName', 'RCP4.5')
%plot(t,emissions*0.469, 'DisplayName', 'emissions')
legend('Location','southeast')
xlabel('Year'), ylabel('CO_2 concentration (ppm)')

%%  Del 2 - Radiative forcing
% uppgift 8

clear, clc, clf
totRadForcExclCO2AndAerosols	= [0	0.115653444	0.251852421	0.256772281	0.21894257	0.218662979	0.259240629	0.274128052	0.263715683	0.249641179	0.238842165	0.24516418	0.272219646	0.302402384	0.310191962	0.302471248	0.293277521	0.249428376	0.132442595	0.04546089	0.115843943	0.2409541	0.302228607	0.308758611	0.195824757	0.031526544	0.049079212	0.172332524	0.23218477	0.22747827	0.190773442	0.177218677	0.192953549	0.207144648	0.213703669	0.23042582	0.251730578	0.248292338	0.232695799	0.228873797	0.22688789	0.217079623	0.207049891	-0.288063492	-1.432583888	-1.835225463	-1.039544299	-0.362618293	-0.161734092	-0.683174499	-2.146158602	-2.647045861	-1.477800511	-0.349345887	0.101159597	0.227302718	0.234152981	0.236913494	0.241604664	0.250046637	0.264208279	0.282755463	0.302280349	0.31267249	0.286334542	0.07059477	-0.321273268	-0.427595945	-0.135478426	-0.285498133	-0.886015654	-0.797080872	-0.182349169	0.193958939	0.30957468	0.290781286	0.267335976	0.267729314	0.240486098	0.234404641	0.283643618	0.334607869	0.371155547	0.398394488	0.382637532	0.342661444	0.334194749	0.338274987	0.333926336	0.325079597	0.184135622	-0.270701965	-0.504879886	-0.159822708	0.197818888	0.332032465	0.308787805	0.206705041	0.206849986	0.278889867	0.315133894	0.325931334	0.33742729	0.363518892	0.395412426	0.422015857	0.426645026	0.395538269	0.35406617	0.336504589	0.309899989	0.259123863	0.252376955	0.284053268	0.314109429	0.349503923	0.377269521	0.278831575	-0.629717546	-1.373927045	-0.800080887	-0.323770859	-0.207057768	-0.100691462	-0.167355374	-0.206323788	-0.105892434	0.09628362	0.266655774	0.386777178	0.36677811	0.196555121	0.095979808	0.190147272	0.298552342	0.344506769	0.327173489	-0.113790262	-0.474166121	-0.152451355	0.212517922	0.316817217	0.297380813	0.309295553	0.367502712	0.386955244	0.384655847	0.142469828	0.044747057	0.283698513	0.43263847	0.504926821	0.539494712	0.544118701	0.513536131	0.405936135	0.37234803	0.447712685	0.47375747	0.479011799	0.508073244	0.547260979	0.564197508	0.514129624	0.459999959	0.48207783	0.494661458	0.447371348	0.45119702	0.509172645	0.562700164	0.619237352	0.631705145	0.611896493	0.610231628	0.625996601	0.626160414	0.589091869	0.571990642	0.608405371	0.654051893	0.694977724	0.720413015	0.742174692	0.728470769	0.69787577	0.666187529	0.637413808	0.624309607	0.639054306	0.702878524	0.789673585	0.861303922	0.878147945	0.862438037	0.770080682	0.643959431	0.544238987	0.064992161	-0.278618322	0.069158369	0.49375619	0.667011447	0.504176985	0.457439657	0.71169703	0.889341414	0.944017858	0.901528461	0.753531286	0.664636749	0.81866331	1.030431828	1.093936205	1.155776228	1.25472466	1.195712861	0.497982973	0.181685802	0.709800594	0.992174407	1.06624936	1.13962008	1.25615126	1.35861424	1.38598613	0.43002636	-0.20014154	0.5062205	1.02436749	1.19750461	1.26318155	1.32400737	1.418781354	1.512371514	1.566890933	1.584131132	1.573295813	1.536130684	1.497623741	1.42695926	1.29936181	1.224840503	1.221944658	1.272839613	1.350555721	1.389231524	1.402708811	1.390630427	1.350778504	1.310808261	1.288179927	1.276313914	1.26967103	1.267795187	1.319478017	1.397457733	1.436743594	1.450574994	1.438350984	1.398344554	1.357997044	1.334769334	1.322080745	1.314395545	1.310843062	1.360610934	1.436521243	1.472789511	1.48302551	1.467023409	1.423019968	1.378434527	1.350708396	1.333247185	1.320505198	1.311604279	1.355316334	1.424985028	1.455426263	1.459961498	1.438460293	1.389217168	1.339695623	1.307369318	1.285714786	1.26925592	1.257008107	1.298085813	1.36586909	1.394717557	1.397900543	1.37524554	1.325016217	1.274657634	1.241623544	1.219327054	1.202204318	1.189352461	1.229955555	1.297340469	1.325853632	1.328751876	1.305852089	1.255408973	1.204860137	1.17165475	1.149174933	1.131847317	1.1187913	1.159193753	1.226381036	1.25469927	1.257413373	1.234409816	1.183990427	1.133570781	1.101464943	1.081181544	1.066382546	1.056155067	1.099652799	1.17017423	1.202040762	1.208483473	1.18929603	1.142711377	1.096144839	1.067025631	1.048747173	1.035751036	1.027145138	1.07210183	1.143937052	1.176987664	1.18449907	1.166279496	1.120835296	1.075637496	1.047901096	1.031012396	1.019407396	1.012189196	1.058526396	1.131732296	1.166141396	1.174995996	1.158099496	1.113693996	1.069204696	1.042069596	1.025689196	1.014511196	1.007649196	1.054280796	1.127727396	1.162329996	1.171336296	1.154554796	1.110232096	1.065799896	1.038699096	1.022329696	1.011141996	1.004251996	1.050839596	1.124228096	1.158760896	1.167687396	1.150816996	1.106397396	1.061858296	1.034642096	1.018152896	1.006841996	0.999825696	1.046284496	1.119542296	1.153943296	1.162736696	1.145732496	1.101178296	1.056503996	1.029152196	1.045671396	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796];
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																
CO2RadForc	=[0	0.011049082	0.023246047	0.025605215	0.028057033	0.03055287	0.033093627	0.035705793	0.038397133	0.041160901	0.044009648	0.046979223	0.050067292	0.053202569	0.05628708	0.059234532	0.06201229	0.064664134	0.067271913	0.069921132	0.072693308	0.075631696	0.078703283	0.081821836	0.084889902	0.087836927	0.090660982	0.09339792	0.096060423	0.098642066	0.1011408	0.10356312	0.10591503	0.10819345	0.11039084	0.11250486	0.11454316	0.11651278	0.1184099	0.12022542	0.1219681	0.1236704	0.12533497	0.12690511	0.12830042	0.12946317	0.1304044	0.13119381	0.13190268	0.13259134	0.13331508	0.13409903	0.13491805	0.13571684	0.13643515	0.13702906	0.13750239	0.13789659	0.13825059	0.13859452	0.13895098	0.13932247	0.13969896	0.14007543	0.14045187	0.14082828	0.14054596	0.1385692	0.1356501	0.13282363	0.12999566	0.1271662	0.12433524	0.12244727	0.12197515	0.12197515	0.12244727	0.12386337	0.12575101	0.12810952	0.13140969	0.13470811	0.13753359	0.14082795	0.14412058	0.14694109	0.14976013	0.15210829	0.15445521	0.15727029	0.16008389	0.162896	0.16570665	0.16898372	0.17225908	0.17506481	0.17786907	0.18020493	0.18253957	0.18533992	0.18767253	0.1895378	0.19140242	0.19373219	0.19652669	0.19931973	0.2025763	0.20629582	0.21047702	0.21558294	0.22114773	0.22716948	0.23410923	0.24150205	0.24934541	0.25809794	0.26729609	0.27602009	0.28427149	0.29251018	0.29982345	0.30575788	0.31077419	0.31487495	0.31851727	0.32170241	0.32443091	0.32715801	0.32942964	0.33124617	0.33306208	0.33487737	0.33714553	0.34077243	0.34575562	0.35118677	0.35706406	0.36338651	0.36970149	0.37645901	0.38410722	0.39219378	0.3998202	0.4069878	0.41414581	0.42129426	0.42798755	0.43422682	0.44045882	0.44623943	0.45156962	0.45733777	0.46354294	0.46929869	0.47460598	0.48034937	0.48696871	0.49358042	0.49974374	0.50677828	0.51468174	0.52213573	0.52957874	0.53788518	0.54617941	0.55402496	0.56229357	0.5705501	0.57792673	0.5848599	0.59178409	0.59783591	0.60215445	0.60517523	0.60733189	0.60862547	0.60862547	0.60733189	0.60560671	0.6043125	0.60388103	0.6043125	0.60560671	0.60776302	0.6107804	0.61508782	0.62111239	0.62798987	0.63528723	0.64385931	0.65370065	0.66395102	0.67460724	0.68520067	0.69628068	0.7093687	0.72293323	0.73507442	0.74521338	0.75407365	0.76618156	0.7828982	0.79886038	0.81597004	0.83695475	0.85481939	0.86912845	0.89018132	0.91528331	0.93260715	0.94626302	0.96504571	0.9895882	1.0148272	1.0415665	1.0706749	1.0922769	1.1090268	1.131041	1.1557767	1.1790812	1.2025127	1.23094	1.2629696	1.289621	1.3103479	1.3279065	1.3409723	1.354375	1.3745818	1.400075	1.4241974	1.4491927	1.4810336	1.5106359	1.5327048	1.5559009	1.5854995	1.6175545	1.6467939	1.675125	1.7035227	1.7308597	1.7590634	1.7889061	1.8189254	1.8483587	1.8776554	1.9069846	1.9364166	1.9659683	1.995568	2.0251167	2.0545783	2.0839653	2.1132986	2.142503	2.1717034	2.2011892	2.231053	2.2613025	2.2919099	2.3227715	2.3537626	2.3848242	2.4159493	2.4471439	2.4781534	2.5088668	2.5395246	2.5702467	2.6010645	2.6319705	2.662877	2.6936716	2.7243024	2.7547673	2.7849151	2.8145156	2.8436248	2.87247	2.9011769	2.9297842	2.9582922	2.9866207	3.0146618	3.0423684	3.0693909	3.095422	3.1204161	3.1444232	3.1676809	3.1903291	3.2124211	3.2339723	3.2549163	3.2751546	3.2944862	3.3127723	3.3300499	3.3462466	3.3614003	3.3757368	3.3893909	3.4024123	3.4148148	3.4265291	3.4372972	3.4469269	3.4554329	3.4628368	3.4690594	3.4741267	3.4782569	3.4815823	3.4841511	3.4859786	3.4876965	3.4898332	3.4922482	3.4948901	3.4977254	3.5006277	3.5035829	3.5067763	3.5103153	3.5142262	3.5185	3.5230427	3.5277246	3.5324729	3.5372666	3.5421013	3.546871	3.551578	3.5564214	3.5615212	3.5666508	3.5715667	3.5762077	3.5804644	3.5842837	3.5876611	3.5906065	3.5930255	3.5949304	3.5965304	3.5980276	3.5995347	3.6010524	3.6024967	3.6037448	3.6047301	3.6054375	3.605868	3.605919	3.6055958	3.6052119	3.6049934	3.6049722	3.6051476	3.6054302	3.6056931	3.6058657	3.6059297	3.605883	3.6056196	3.6051589	3.6047192	3.6044236	3.6043129	3.6043903	3.6045701	3.6047277	3.6047946	3.6047542	3.6046058	3.6042426	3.6036662	3.6030813	3.6026139	3.6023072	3.6021664	3.602107	3.6020055	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319];

totRadForcAerosols =	[0	-0.000675976	-0.002066998	-0.003506856	-0.004954363	-0.006391459	-0.008191986	-0.009976755	-0.011356966	-0.01270254	-0.014012763	-0.015287343	-0.016526278	-0.017729763	-0.018898132	-0.02003182	-0.021567991	-0.02307257	-0.024109188	-0.025112828	-0.026084191	-0.027023976	-0.02793288	-0.028811597	-0.029660819	-0.030481228	-0.031720164	-0.032931794	-0.033670013	-0.034381886	-0.035068072	-0.035729227	-0.036812009	-0.037870688	-0.038459809	-0.03947085	-0.040459338	-0.041867498	-0.042811099	-0.042847477	-0.04330705	-0.044187553	-0.045048591	-0.045450548	-0.045834932	-0.046202307	-0.046988661	-0.047758107	-0.04807573	-0.048378481	-0.049097878	-0.050231969	-0.051347739	-0.052018673	-0.052247777	-0.052465008	-0.052670881	-0.053287704	-0.054313124	-0.054904197	-0.055481569	-0.056048603	-0.056602739	-0.05714743	-0.057268842	-0.05983842	-0.061985112	-0.061662785	-0.062147465	-0.062625217	-0.063093126	-0.065149588	-0.066793151	-0.067226829	-0.06804864	-0.069251536	-0.070443016	-0.071619434	-0.072785088	-0.073936271	-0.076219158	-0.077724999	-0.078830357	-0.080304988	-0.081760072	-0.084206384	-0.085329759	-0.089862367	-0.094906246	-0.098208447	-0.101393282	-0.103266545	-0.105317054	-0.105997353	-0.107968928	-0.116387795	-0.128866385	-0.128795571	-0.125485166	-0.127995847	-0.132042374	-0.140424334	-0.14928997	-0.152486062	-0.151234006	-0.151466987	-0.160402206	-0.179061449	-0.1947542	-0.198352789	-0.198586719	-0.197983873	-0.193504655	-0.191345908	-0.195208839	-0.207646903	-0.215360381	-0.215031415	-0.218087204	-0.220358535	-0.218681403	-0.217795601	-0.220931602	-0.230782424	-0.235671466	-0.238864492	-0.246706766	-0.25198686	-0.255718184	-0.259476638	-0.26487402	-0.268523461	-0.269959278	-0.272220372	-0.276317622	-0.280935729	-0.285747379	-0.291266474	-0.298904499	-0.305709	-0.311545922	-0.319294997	-0.327701203	-0.329640603	-0.329068552	-0.334182054	-0.337618907	-0.338824198	-0.342313677	-0.342011793	-0.33936144	-0.342798461	-0.347957672	-0.350867581	-0.347516451	-0.347677775	-0.3454084	-0.342119065	-0.35465971	-0.364184549	-0.365854464	-0.368151399	-0.372525128	-0.377386134	-0.382166479	-0.38358385	-0.378426528	-0.372771128	-0.37227763	-0.376968865	-0.381187274	-0.385522052	-0.388809485	-0.383465723	-0.380051358	-0.386238251	-0.394132974	-0.400044909	-0.404686862	-0.411219971	-0.417808053	-0.424942444	-0.436550005	-0.451072392	-0.460730359	-0.47132463	-0.485948929	-0.499093718	-0.513493077	-0.528108546	-0.541202914	-0.554526045	-0.569111482	-0.580900275	-0.589886127	-0.599245872	-0.615326031	-0.634162267	-0.648152241	-0.661127268	-0.672664849	-0.68331011	-0.697116357	-0.710948355	-0.719077087	-0.71911438	-0.721449764	-0.736759778	-0.754362971	-0.770767926	-0.789130039	-0.80601477	-0.821191128	-0.832929705	-0.841152228	-0.85933556	-0.880228361	-0.892233563	-0.903960412	-0.913700084	-0.919932207	-0.92639676	-0.93527688	-0.94303346	-0.94762044	-0.95069843	-0.95119214	-0.9576636	-0.963458	-0.96214829	-0.95636781	-0.94950125	-0.95753327	-0.975601654	-0.989785514	-1.003405333	-1.012051132	-1.013435813	-1.015786584	-1.018599741	-1.01833266	-1.01236391	-1.003750303	-0.995114358	-0.986457113	-0.977777721	-0.969073324	-0.960346111	-0.951598327	-0.942829704	-0.934039961	-0.925228827	-0.916396014	-0.90754123	-0.898664187	-0.890292817	-0.882957433	-0.876132694	-0.869290894	-0.862431784	-0.855555154	-0.848660744	-0.841748334	-0.834817645	-0.827868445	-0.820599662	-0.812707934	-0.804490743	-0.796247711	-0.78797841	-0.779682409	-0.771359268	-0.763008527	-0.754629696	-0.746222285	-0.737474398	-0.728070979	-0.718318734	-0.708527328	-0.698695963	-0.688823798	-0.678909993	-0.668953668	-0.658953923	-0.648909818	-0.639894686	-0.63298802	-0.627122907	-0.621226513	-0.61529829	-0.609337657	-0.603344043	-0.59731684	-0.591255417	-0.585159134	-0.579277044	-0.573859554	-0.568658118	-0.563422861	-0.558153155	-0.552848369	-0.547507832	-0.542130876	-0.536716789	-0.531264873	-0.526029137	-0.52126515	-0.516719433	-0.512137017	-0.5075172	-0.502859253	-0.498162436	-0.49342597	-0.488649073	-0.483830916	-0.479956927	-0.478028281	-0.477079243	-0.476128744	-0.475176746	-0.474223267	-0.473268299	-0.47231183	-0.471353862	-0.470394373	-0.46943793	-0.468488977	-0.467542939	-0.466595231	-0.465645873	-0.464694836	-0.463742138	-0.46278773	-0.461831652	-0.460873864	-0.46015457	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596];

p0_co2 = 0.469 * 600; % ppm CO2 / GtC
rf = @(p_co2) 5.35 * log(p_co2 ./ p0_co2);
global CO2ConcRCP45
t = 1765:2500;

plot(t, rf(CO2ConcRCP45), 'DisplayName', 'RCP 4.5')
hold on
plot(t, CO2RadForc, 'DisplayName', 'CO2 rad forc')
legend('Location','southeast')
xlabel('Year'), ylabel('Radiative forcing')

%%  Del 2 - Radiative forcing
% uppgift 9

clear, clc, clf
totRadForcExclCO2AndAerosols	= [0	0.115653444	0.251852421	0.256772281	0.21894257	0.218662979	0.259240629	0.274128052	0.263715683	0.249641179	0.238842165	0.24516418	0.272219646	0.302402384	0.310191962	0.302471248	0.293277521	0.249428376	0.132442595	0.04546089	0.115843943	0.2409541	0.302228607	0.308758611	0.195824757	0.031526544	0.049079212	0.172332524	0.23218477	0.22747827	0.190773442	0.177218677	0.192953549	0.207144648	0.213703669	0.23042582	0.251730578	0.248292338	0.232695799	0.228873797	0.22688789	0.217079623	0.207049891	-0.288063492	-1.432583888	-1.835225463	-1.039544299	-0.362618293	-0.161734092	-0.683174499	-2.146158602	-2.647045861	-1.477800511	-0.349345887	0.101159597	0.227302718	0.234152981	0.236913494	0.241604664	0.250046637	0.264208279	0.282755463	0.302280349	0.31267249	0.286334542	0.07059477	-0.321273268	-0.427595945	-0.135478426	-0.285498133	-0.886015654	-0.797080872	-0.182349169	0.193958939	0.30957468	0.290781286	0.267335976	0.267729314	0.240486098	0.234404641	0.283643618	0.334607869	0.371155547	0.398394488	0.382637532	0.342661444	0.334194749	0.338274987	0.333926336	0.325079597	0.184135622	-0.270701965	-0.504879886	-0.159822708	0.197818888	0.332032465	0.308787805	0.206705041	0.206849986	0.278889867	0.315133894	0.325931334	0.33742729	0.363518892	0.395412426	0.422015857	0.426645026	0.395538269	0.35406617	0.336504589	0.309899989	0.259123863	0.252376955	0.284053268	0.314109429	0.349503923	0.377269521	0.278831575	-0.629717546	-1.373927045	-0.800080887	-0.323770859	-0.207057768	-0.100691462	-0.167355374	-0.206323788	-0.105892434	0.09628362	0.266655774	0.386777178	0.36677811	0.196555121	0.095979808	0.190147272	0.298552342	0.344506769	0.327173489	-0.113790262	-0.474166121	-0.152451355	0.212517922	0.316817217	0.297380813	0.309295553	0.367502712	0.386955244	0.384655847	0.142469828	0.044747057	0.283698513	0.43263847	0.504926821	0.539494712	0.544118701	0.513536131	0.405936135	0.37234803	0.447712685	0.47375747	0.479011799	0.508073244	0.547260979	0.564197508	0.514129624	0.459999959	0.48207783	0.494661458	0.447371348	0.45119702	0.509172645	0.562700164	0.619237352	0.631705145	0.611896493	0.610231628	0.625996601	0.626160414	0.589091869	0.571990642	0.608405371	0.654051893	0.694977724	0.720413015	0.742174692	0.728470769	0.69787577	0.666187529	0.637413808	0.624309607	0.639054306	0.702878524	0.789673585	0.861303922	0.878147945	0.862438037	0.770080682	0.643959431	0.544238987	0.064992161	-0.278618322	0.069158369	0.49375619	0.667011447	0.504176985	0.457439657	0.71169703	0.889341414	0.944017858	0.901528461	0.753531286	0.664636749	0.81866331	1.030431828	1.093936205	1.155776228	1.25472466	1.195712861	0.497982973	0.181685802	0.709800594	0.992174407	1.06624936	1.13962008	1.25615126	1.35861424	1.38598613	0.43002636	-0.20014154	0.5062205	1.02436749	1.19750461	1.26318155	1.32400737	1.418781354	1.512371514	1.566890933	1.584131132	1.573295813	1.536130684	1.497623741	1.42695926	1.29936181	1.224840503	1.221944658	1.272839613	1.350555721	1.389231524	1.402708811	1.390630427	1.350778504	1.310808261	1.288179927	1.276313914	1.26967103	1.267795187	1.319478017	1.397457733	1.436743594	1.450574994	1.438350984	1.398344554	1.357997044	1.334769334	1.322080745	1.314395545	1.310843062	1.360610934	1.436521243	1.472789511	1.48302551	1.467023409	1.423019968	1.378434527	1.350708396	1.333247185	1.320505198	1.311604279	1.355316334	1.424985028	1.455426263	1.459961498	1.438460293	1.389217168	1.339695623	1.307369318	1.285714786	1.26925592	1.257008107	1.298085813	1.36586909	1.394717557	1.397900543	1.37524554	1.325016217	1.274657634	1.241623544	1.219327054	1.202204318	1.189352461	1.229955555	1.297340469	1.325853632	1.328751876	1.305852089	1.255408973	1.204860137	1.17165475	1.149174933	1.131847317	1.1187913	1.159193753	1.226381036	1.25469927	1.257413373	1.234409816	1.183990427	1.133570781	1.101464943	1.081181544	1.066382546	1.056155067	1.099652799	1.17017423	1.202040762	1.208483473	1.18929603	1.142711377	1.096144839	1.067025631	1.048747173	1.035751036	1.027145138	1.07210183	1.143937052	1.176987664	1.18449907	1.166279496	1.120835296	1.075637496	1.047901096	1.031012396	1.019407396	1.012189196	1.058526396	1.131732296	1.166141396	1.174995996	1.158099496	1.113693996	1.069204696	1.042069596	1.025689196	1.014511196	1.007649196	1.054280796	1.127727396	1.162329996	1.171336296	1.154554796	1.110232096	1.065799896	1.038699096	1.022329696	1.011141996	1.004251996	1.050839596	1.124228096	1.158760896	1.167687396	1.150816996	1.106397396	1.061858296	1.034642096	1.018152896	1.006841996	0.999825696	1.046284496	1.119542296	1.153943296	1.162736696	1.145732496	1.101178296	1.056503996	1.029152196	1.045671396	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796];																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															
CO2RadForc	=[0	0.011049082	0.023246047	0.025605215	0.028057033	0.03055287	0.033093627	0.035705793	0.038397133	0.041160901	0.044009648	0.046979223	0.050067292	0.053202569	0.05628708	0.059234532	0.06201229	0.064664134	0.067271913	0.069921132	0.072693308	0.075631696	0.078703283	0.081821836	0.084889902	0.087836927	0.090660982	0.09339792	0.096060423	0.098642066	0.1011408	0.10356312	0.10591503	0.10819345	0.11039084	0.11250486	0.11454316	0.11651278	0.1184099	0.12022542	0.1219681	0.1236704	0.12533497	0.12690511	0.12830042	0.12946317	0.1304044	0.13119381	0.13190268	0.13259134	0.13331508	0.13409903	0.13491805	0.13571684	0.13643515	0.13702906	0.13750239	0.13789659	0.13825059	0.13859452	0.13895098	0.13932247	0.13969896	0.14007543	0.14045187	0.14082828	0.14054596	0.1385692	0.1356501	0.13282363	0.12999566	0.1271662	0.12433524	0.12244727	0.12197515	0.12197515	0.12244727	0.12386337	0.12575101	0.12810952	0.13140969	0.13470811	0.13753359	0.14082795	0.14412058	0.14694109	0.14976013	0.15210829	0.15445521	0.15727029	0.16008389	0.162896	0.16570665	0.16898372	0.17225908	0.17506481	0.17786907	0.18020493	0.18253957	0.18533992	0.18767253	0.1895378	0.19140242	0.19373219	0.19652669	0.19931973	0.2025763	0.20629582	0.21047702	0.21558294	0.22114773	0.22716948	0.23410923	0.24150205	0.24934541	0.25809794	0.26729609	0.27602009	0.28427149	0.29251018	0.29982345	0.30575788	0.31077419	0.31487495	0.31851727	0.32170241	0.32443091	0.32715801	0.32942964	0.33124617	0.33306208	0.33487737	0.33714553	0.34077243	0.34575562	0.35118677	0.35706406	0.36338651	0.36970149	0.37645901	0.38410722	0.39219378	0.3998202	0.4069878	0.41414581	0.42129426	0.42798755	0.43422682	0.44045882	0.44623943	0.45156962	0.45733777	0.46354294	0.46929869	0.47460598	0.48034937	0.48696871	0.49358042	0.49974374	0.50677828	0.51468174	0.52213573	0.52957874	0.53788518	0.54617941	0.55402496	0.56229357	0.5705501	0.57792673	0.5848599	0.59178409	0.59783591	0.60215445	0.60517523	0.60733189	0.60862547	0.60862547	0.60733189	0.60560671	0.6043125	0.60388103	0.6043125	0.60560671	0.60776302	0.6107804	0.61508782	0.62111239	0.62798987	0.63528723	0.64385931	0.65370065	0.66395102	0.67460724	0.68520067	0.69628068	0.7093687	0.72293323	0.73507442	0.74521338	0.75407365	0.76618156	0.7828982	0.79886038	0.81597004	0.83695475	0.85481939	0.86912845	0.89018132	0.91528331	0.93260715	0.94626302	0.96504571	0.9895882	1.0148272	1.0415665	1.0706749	1.0922769	1.1090268	1.131041	1.1557767	1.1790812	1.2025127	1.23094	1.2629696	1.289621	1.3103479	1.3279065	1.3409723	1.354375	1.3745818	1.400075	1.4241974	1.4491927	1.4810336	1.5106359	1.5327048	1.5559009	1.5854995	1.6175545	1.6467939	1.675125	1.7035227	1.7308597	1.7590634	1.7889061	1.8189254	1.8483587	1.8776554	1.9069846	1.9364166	1.9659683	1.995568	2.0251167	2.0545783	2.0839653	2.1132986	2.142503	2.1717034	2.2011892	2.231053	2.2613025	2.2919099	2.3227715	2.3537626	2.3848242	2.4159493	2.4471439	2.4781534	2.5088668	2.5395246	2.5702467	2.6010645	2.6319705	2.662877	2.6936716	2.7243024	2.7547673	2.7849151	2.8145156	2.8436248	2.87247	2.9011769	2.9297842	2.9582922	2.9866207	3.0146618	3.0423684	3.0693909	3.095422	3.1204161	3.1444232	3.1676809	3.1903291	3.2124211	3.2339723	3.2549163	3.2751546	3.2944862	3.3127723	3.3300499	3.3462466	3.3614003	3.3757368	3.3893909	3.4024123	3.4148148	3.4265291	3.4372972	3.4469269	3.4554329	3.4628368	3.4690594	3.4741267	3.4782569	3.4815823	3.4841511	3.4859786	3.4876965	3.4898332	3.4922482	3.4948901	3.4977254	3.5006277	3.5035829	3.5067763	3.5103153	3.5142262	3.5185	3.5230427	3.5277246	3.5324729	3.5372666	3.5421013	3.546871	3.551578	3.5564214	3.5615212	3.5666508	3.5715667	3.5762077	3.5804644	3.5842837	3.5876611	3.5906065	3.5930255	3.5949304	3.5965304	3.5980276	3.5995347	3.6010524	3.6024967	3.6037448	3.6047301	3.6054375	3.605868	3.605919	3.6055958	3.6052119	3.6049934	3.6049722	3.6051476	3.6054302	3.6056931	3.6058657	3.6059297	3.605883	3.6056196	3.6051589	3.6047192	3.6044236	3.6043129	3.6043903	3.6045701	3.6047277	3.6047946	3.6047542	3.6046058	3.6042426	3.6036662	3.6030813	3.6026139	3.6023072	3.6021664	3.602107	3.6020055	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319];

totRadForcAerosols =	[0	-0.000675976	-0.002066998	-0.003506856	-0.004954363	-0.006391459	-0.008191986	-0.009976755	-0.011356966	-0.01270254	-0.014012763	-0.015287343	-0.016526278	-0.017729763	-0.018898132	-0.02003182	-0.021567991	-0.02307257	-0.024109188	-0.025112828	-0.026084191	-0.027023976	-0.02793288	-0.028811597	-0.029660819	-0.030481228	-0.031720164	-0.032931794	-0.033670013	-0.034381886	-0.035068072	-0.035729227	-0.036812009	-0.037870688	-0.038459809	-0.03947085	-0.040459338	-0.041867498	-0.042811099	-0.042847477	-0.04330705	-0.044187553	-0.045048591	-0.045450548	-0.045834932	-0.046202307	-0.046988661	-0.047758107	-0.04807573	-0.048378481	-0.049097878	-0.050231969	-0.051347739	-0.052018673	-0.052247777	-0.052465008	-0.052670881	-0.053287704	-0.054313124	-0.054904197	-0.055481569	-0.056048603	-0.056602739	-0.05714743	-0.057268842	-0.05983842	-0.061985112	-0.061662785	-0.062147465	-0.062625217	-0.063093126	-0.065149588	-0.066793151	-0.067226829	-0.06804864	-0.069251536	-0.070443016	-0.071619434	-0.072785088	-0.073936271	-0.076219158	-0.077724999	-0.078830357	-0.080304988	-0.081760072	-0.084206384	-0.085329759	-0.089862367	-0.094906246	-0.098208447	-0.101393282	-0.103266545	-0.105317054	-0.105997353	-0.107968928	-0.116387795	-0.128866385	-0.128795571	-0.125485166	-0.127995847	-0.132042374	-0.140424334	-0.14928997	-0.152486062	-0.151234006	-0.151466987	-0.160402206	-0.179061449	-0.1947542	-0.198352789	-0.198586719	-0.197983873	-0.193504655	-0.191345908	-0.195208839	-0.207646903	-0.215360381	-0.215031415	-0.218087204	-0.220358535	-0.218681403	-0.217795601	-0.220931602	-0.230782424	-0.235671466	-0.238864492	-0.246706766	-0.25198686	-0.255718184	-0.259476638	-0.26487402	-0.268523461	-0.269959278	-0.272220372	-0.276317622	-0.280935729	-0.285747379	-0.291266474	-0.298904499	-0.305709	-0.311545922	-0.319294997	-0.327701203	-0.329640603	-0.329068552	-0.334182054	-0.337618907	-0.338824198	-0.342313677	-0.342011793	-0.33936144	-0.342798461	-0.347957672	-0.350867581	-0.347516451	-0.347677775	-0.3454084	-0.342119065	-0.35465971	-0.364184549	-0.365854464	-0.368151399	-0.372525128	-0.377386134	-0.382166479	-0.38358385	-0.378426528	-0.372771128	-0.37227763	-0.376968865	-0.381187274	-0.385522052	-0.388809485	-0.383465723	-0.380051358	-0.386238251	-0.394132974	-0.400044909	-0.404686862	-0.411219971	-0.417808053	-0.424942444	-0.436550005	-0.451072392	-0.460730359	-0.47132463	-0.485948929	-0.499093718	-0.513493077	-0.528108546	-0.541202914	-0.554526045	-0.569111482	-0.580900275	-0.589886127	-0.599245872	-0.615326031	-0.634162267	-0.648152241	-0.661127268	-0.672664849	-0.68331011	-0.697116357	-0.710948355	-0.719077087	-0.71911438	-0.721449764	-0.736759778	-0.754362971	-0.770767926	-0.789130039	-0.80601477	-0.821191128	-0.832929705	-0.841152228	-0.85933556	-0.880228361	-0.892233563	-0.903960412	-0.913700084	-0.919932207	-0.92639676	-0.93527688	-0.94303346	-0.94762044	-0.95069843	-0.95119214	-0.9576636	-0.963458	-0.96214829	-0.95636781	-0.94950125	-0.95753327	-0.975601654	-0.989785514	-1.003405333	-1.012051132	-1.013435813	-1.015786584	-1.018599741	-1.01833266	-1.01236391	-1.003750303	-0.995114358	-0.986457113	-0.977777721	-0.969073324	-0.960346111	-0.951598327	-0.942829704	-0.934039961	-0.925228827	-0.916396014	-0.90754123	-0.898664187	-0.890292817	-0.882957433	-0.876132694	-0.869290894	-0.862431784	-0.855555154	-0.848660744	-0.841748334	-0.834817645	-0.827868445	-0.820599662	-0.812707934	-0.804490743	-0.796247711	-0.78797841	-0.779682409	-0.771359268	-0.763008527	-0.754629696	-0.746222285	-0.737474398	-0.728070979	-0.718318734	-0.708527328	-0.698695963	-0.688823798	-0.678909993	-0.668953668	-0.658953923	-0.648909818	-0.639894686	-0.63298802	-0.627122907	-0.621226513	-0.61529829	-0.609337657	-0.603344043	-0.59731684	-0.591255417	-0.585159134	-0.579277044	-0.573859554	-0.568658118	-0.563422861	-0.558153155	-0.552848369	-0.547507832	-0.542130876	-0.536716789	-0.531264873	-0.526029137	-0.52126515	-0.516719433	-0.512137017	-0.5075172	-0.502859253	-0.498162436	-0.49342597	-0.488649073	-0.483830916	-0.479956927	-0.478028281	-0.477079243	-0.476128744	-0.475176746	-0.474223267	-0.473268299	-0.47231183	-0.471353862	-0.470394373	-0.46943793	-0.468488977	-0.467542939	-0.466595231	-0.465645873	-0.464694836	-0.463742138	-0.46278773	-0.461831652	-0.460873864	-0.46015457	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596];

t = 1765:2500;
s = 1; 

plot(t, s * totRadForcAerosols + totRadForcExclCO2AndAerosols)
xlabel('Year'), ylabel('Radiative forcing')
title('Radiative forcing without CO2')

%% uppgift 10 a,b
clear, clc, clf

totRadForcExclCO2AndAerosols	= [0	0.115653444	0.251852421	0.256772281	0.21894257	0.218662979	0.259240629	0.274128052	0.263715683	0.249641179	0.238842165	0.24516418	0.272219646	0.302402384	0.310191962	0.302471248	0.293277521	0.249428376	0.132442595	0.04546089	0.115843943	0.2409541	0.302228607	0.308758611	0.195824757	0.031526544	0.049079212	0.172332524	0.23218477	0.22747827	0.190773442	0.177218677	0.192953549	0.207144648	0.213703669	0.23042582	0.251730578	0.248292338	0.232695799	0.228873797	0.22688789	0.217079623	0.207049891	-0.288063492	-1.432583888	-1.835225463	-1.039544299	-0.362618293	-0.161734092	-0.683174499	-2.146158602	-2.647045861	-1.477800511	-0.349345887	0.101159597	0.227302718	0.234152981	0.236913494	0.241604664	0.250046637	0.264208279	0.282755463	0.302280349	0.31267249	0.286334542	0.07059477	-0.321273268	-0.427595945	-0.135478426	-0.285498133	-0.886015654	-0.797080872	-0.182349169	0.193958939	0.30957468	0.290781286	0.267335976	0.267729314	0.240486098	0.234404641	0.283643618	0.334607869	0.371155547	0.398394488	0.382637532	0.342661444	0.334194749	0.338274987	0.333926336	0.325079597	0.184135622	-0.270701965	-0.504879886	-0.159822708	0.197818888	0.332032465	0.308787805	0.206705041	0.206849986	0.278889867	0.315133894	0.325931334	0.33742729	0.363518892	0.395412426	0.422015857	0.426645026	0.395538269	0.35406617	0.336504589	0.309899989	0.259123863	0.252376955	0.284053268	0.314109429	0.349503923	0.377269521	0.278831575	-0.629717546	-1.373927045	-0.800080887	-0.323770859	-0.207057768	-0.100691462	-0.167355374	-0.206323788	-0.105892434	0.09628362	0.266655774	0.386777178	0.36677811	0.196555121	0.095979808	0.190147272	0.298552342	0.344506769	0.327173489	-0.113790262	-0.474166121	-0.152451355	0.212517922	0.316817217	0.297380813	0.309295553	0.367502712	0.386955244	0.384655847	0.142469828	0.044747057	0.283698513	0.43263847	0.504926821	0.539494712	0.544118701	0.513536131	0.405936135	0.37234803	0.447712685	0.47375747	0.479011799	0.508073244	0.547260979	0.564197508	0.514129624	0.459999959	0.48207783	0.494661458	0.447371348	0.45119702	0.509172645	0.562700164	0.619237352	0.631705145	0.611896493	0.610231628	0.625996601	0.626160414	0.589091869	0.571990642	0.608405371	0.654051893	0.694977724	0.720413015	0.742174692	0.728470769	0.69787577	0.666187529	0.637413808	0.624309607	0.639054306	0.702878524	0.789673585	0.861303922	0.878147945	0.862438037	0.770080682	0.643959431	0.544238987	0.064992161	-0.278618322	0.069158369	0.49375619	0.667011447	0.504176985	0.457439657	0.71169703	0.889341414	0.944017858	0.901528461	0.753531286	0.664636749	0.81866331	1.030431828	1.093936205	1.155776228	1.25472466	1.195712861	0.497982973	0.181685802	0.709800594	0.992174407	1.06624936	1.13962008	1.25615126	1.35861424	1.38598613	0.43002636	-0.20014154	0.5062205	1.02436749	1.19750461	1.26318155	1.32400737	1.418781354	1.512371514	1.566890933	1.584131132	1.573295813	1.536130684	1.497623741	1.42695926	1.29936181	1.224840503	1.221944658	1.272839613	1.350555721	1.389231524	1.402708811	1.390630427	1.350778504	1.310808261	1.288179927	1.276313914	1.26967103	1.267795187	1.319478017	1.397457733	1.436743594	1.450574994	1.438350984	1.398344554	1.357997044	1.334769334	1.322080745	1.314395545	1.310843062	1.360610934	1.436521243	1.472789511	1.48302551	1.467023409	1.423019968	1.378434527	1.350708396	1.333247185	1.320505198	1.311604279	1.355316334	1.424985028	1.455426263	1.459961498	1.438460293	1.389217168	1.339695623	1.307369318	1.285714786	1.26925592	1.257008107	1.298085813	1.36586909	1.394717557	1.397900543	1.37524554	1.325016217	1.274657634	1.241623544	1.219327054	1.202204318	1.189352461	1.229955555	1.297340469	1.325853632	1.328751876	1.305852089	1.255408973	1.204860137	1.17165475	1.149174933	1.131847317	1.1187913	1.159193753	1.226381036	1.25469927	1.257413373	1.234409816	1.183990427	1.133570781	1.101464943	1.081181544	1.066382546	1.056155067	1.099652799	1.17017423	1.202040762	1.208483473	1.18929603	1.142711377	1.096144839	1.067025631	1.048747173	1.035751036	1.027145138	1.07210183	1.143937052	1.176987664	1.18449907	1.166279496	1.120835296	1.075637496	1.047901096	1.031012396	1.019407396	1.012189196	1.058526396	1.131732296	1.166141396	1.174995996	1.158099496	1.113693996	1.069204696	1.042069596	1.025689196	1.014511196	1.007649196	1.054280796	1.127727396	1.162329996	1.171336296	1.154554796	1.110232096	1.065799896	1.038699096	1.022329696	1.011141996	1.004251996	1.050839596	1.124228096	1.158760896	1.167687396	1.150816996	1.106397396	1.061858296	1.034642096	1.018152896	1.006841996	0.999825696	1.046284496	1.119542296	1.153943296	1.162736696	1.145732496	1.101178296	1.056503996	1.029152196	1.045671396	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796];																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															
CO2RadForc	=[0	0.011049082	0.023246047	0.025605215	0.028057033	0.03055287	0.033093627	0.035705793	0.038397133	0.041160901	0.044009648	0.046979223	0.050067292	0.053202569	0.05628708	0.059234532	0.06201229	0.064664134	0.067271913	0.069921132	0.072693308	0.075631696	0.078703283	0.081821836	0.084889902	0.087836927	0.090660982	0.09339792	0.096060423	0.098642066	0.1011408	0.10356312	0.10591503	0.10819345	0.11039084	0.11250486	0.11454316	0.11651278	0.1184099	0.12022542	0.1219681	0.1236704	0.12533497	0.12690511	0.12830042	0.12946317	0.1304044	0.13119381	0.13190268	0.13259134	0.13331508	0.13409903	0.13491805	0.13571684	0.13643515	0.13702906	0.13750239	0.13789659	0.13825059	0.13859452	0.13895098	0.13932247	0.13969896	0.14007543	0.14045187	0.14082828	0.14054596	0.1385692	0.1356501	0.13282363	0.12999566	0.1271662	0.12433524	0.12244727	0.12197515	0.12197515	0.12244727	0.12386337	0.12575101	0.12810952	0.13140969	0.13470811	0.13753359	0.14082795	0.14412058	0.14694109	0.14976013	0.15210829	0.15445521	0.15727029	0.16008389	0.162896	0.16570665	0.16898372	0.17225908	0.17506481	0.17786907	0.18020493	0.18253957	0.18533992	0.18767253	0.1895378	0.19140242	0.19373219	0.19652669	0.19931973	0.2025763	0.20629582	0.21047702	0.21558294	0.22114773	0.22716948	0.23410923	0.24150205	0.24934541	0.25809794	0.26729609	0.27602009	0.28427149	0.29251018	0.29982345	0.30575788	0.31077419	0.31487495	0.31851727	0.32170241	0.32443091	0.32715801	0.32942964	0.33124617	0.33306208	0.33487737	0.33714553	0.34077243	0.34575562	0.35118677	0.35706406	0.36338651	0.36970149	0.37645901	0.38410722	0.39219378	0.3998202	0.4069878	0.41414581	0.42129426	0.42798755	0.43422682	0.44045882	0.44623943	0.45156962	0.45733777	0.46354294	0.46929869	0.47460598	0.48034937	0.48696871	0.49358042	0.49974374	0.50677828	0.51468174	0.52213573	0.52957874	0.53788518	0.54617941	0.55402496	0.56229357	0.5705501	0.57792673	0.5848599	0.59178409	0.59783591	0.60215445	0.60517523	0.60733189	0.60862547	0.60862547	0.60733189	0.60560671	0.6043125	0.60388103	0.6043125	0.60560671	0.60776302	0.6107804	0.61508782	0.62111239	0.62798987	0.63528723	0.64385931	0.65370065	0.66395102	0.67460724	0.68520067	0.69628068	0.7093687	0.72293323	0.73507442	0.74521338	0.75407365	0.76618156	0.7828982	0.79886038	0.81597004	0.83695475	0.85481939	0.86912845	0.89018132	0.91528331	0.93260715	0.94626302	0.96504571	0.9895882	1.0148272	1.0415665	1.0706749	1.0922769	1.1090268	1.131041	1.1557767	1.1790812	1.2025127	1.23094	1.2629696	1.289621	1.3103479	1.3279065	1.3409723	1.354375	1.3745818	1.400075	1.4241974	1.4491927	1.4810336	1.5106359	1.5327048	1.5559009	1.5854995	1.6175545	1.6467939	1.675125	1.7035227	1.7308597	1.7590634	1.7889061	1.8189254	1.8483587	1.8776554	1.9069846	1.9364166	1.9659683	1.995568	2.0251167	2.0545783	2.0839653	2.1132986	2.142503	2.1717034	2.2011892	2.231053	2.2613025	2.2919099	2.3227715	2.3537626	2.3848242	2.4159493	2.4471439	2.4781534	2.5088668	2.5395246	2.5702467	2.6010645	2.6319705	2.662877	2.6936716	2.7243024	2.7547673	2.7849151	2.8145156	2.8436248	2.87247	2.9011769	2.9297842	2.9582922	2.9866207	3.0146618	3.0423684	3.0693909	3.095422	3.1204161	3.1444232	3.1676809	3.1903291	3.2124211	3.2339723	3.2549163	3.2751546	3.2944862	3.3127723	3.3300499	3.3462466	3.3614003	3.3757368	3.3893909	3.4024123	3.4148148	3.4265291	3.4372972	3.4469269	3.4554329	3.4628368	3.4690594	3.4741267	3.4782569	3.4815823	3.4841511	3.4859786	3.4876965	3.4898332	3.4922482	3.4948901	3.4977254	3.5006277	3.5035829	3.5067763	3.5103153	3.5142262	3.5185	3.5230427	3.5277246	3.5324729	3.5372666	3.5421013	3.546871	3.551578	3.5564214	3.5615212	3.5666508	3.5715667	3.5762077	3.5804644	3.5842837	3.5876611	3.5906065	3.5930255	3.5949304	3.5965304	3.5980276	3.5995347	3.6010524	3.6024967	3.6037448	3.6047301	3.6054375	3.605868	3.605919	3.6055958	3.6052119	3.6049934	3.6049722	3.6051476	3.6054302	3.6056931	3.6058657	3.6059297	3.605883	3.6056196	3.6051589	3.6047192	3.6044236	3.6043129	3.6043903	3.6045701	3.6047277	3.6047946	3.6047542	3.6046058	3.6042426	3.6036662	3.6030813	3.6026139	3.6023072	3.6021664	3.602107	3.6020055	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319];

totRadForcAerosols =	[0	-0.000675976	-0.002066998	-0.003506856	-0.004954363	-0.006391459	-0.008191986	-0.009976755	-0.011356966	-0.01270254	-0.014012763	-0.015287343	-0.016526278	-0.017729763	-0.018898132	-0.02003182	-0.021567991	-0.02307257	-0.024109188	-0.025112828	-0.026084191	-0.027023976	-0.02793288	-0.028811597	-0.029660819	-0.030481228	-0.031720164	-0.032931794	-0.033670013	-0.034381886	-0.035068072	-0.035729227	-0.036812009	-0.037870688	-0.038459809	-0.03947085	-0.040459338	-0.041867498	-0.042811099	-0.042847477	-0.04330705	-0.044187553	-0.045048591	-0.045450548	-0.045834932	-0.046202307	-0.046988661	-0.047758107	-0.04807573	-0.048378481	-0.049097878	-0.050231969	-0.051347739	-0.052018673	-0.052247777	-0.052465008	-0.052670881	-0.053287704	-0.054313124	-0.054904197	-0.055481569	-0.056048603	-0.056602739	-0.05714743	-0.057268842	-0.05983842	-0.061985112	-0.061662785	-0.062147465	-0.062625217	-0.063093126	-0.065149588	-0.066793151	-0.067226829	-0.06804864	-0.069251536	-0.070443016	-0.071619434	-0.072785088	-0.073936271	-0.076219158	-0.077724999	-0.078830357	-0.080304988	-0.081760072	-0.084206384	-0.085329759	-0.089862367	-0.094906246	-0.098208447	-0.101393282	-0.103266545	-0.105317054	-0.105997353	-0.107968928	-0.116387795	-0.128866385	-0.128795571	-0.125485166	-0.127995847	-0.132042374	-0.140424334	-0.14928997	-0.152486062	-0.151234006	-0.151466987	-0.160402206	-0.179061449	-0.1947542	-0.198352789	-0.198586719	-0.197983873	-0.193504655	-0.191345908	-0.195208839	-0.207646903	-0.215360381	-0.215031415	-0.218087204	-0.220358535	-0.218681403	-0.217795601	-0.220931602	-0.230782424	-0.235671466	-0.238864492	-0.246706766	-0.25198686	-0.255718184	-0.259476638	-0.26487402	-0.268523461	-0.269959278	-0.272220372	-0.276317622	-0.280935729	-0.285747379	-0.291266474	-0.298904499	-0.305709	-0.311545922	-0.319294997	-0.327701203	-0.329640603	-0.329068552	-0.334182054	-0.337618907	-0.338824198	-0.342313677	-0.342011793	-0.33936144	-0.342798461	-0.347957672	-0.350867581	-0.347516451	-0.347677775	-0.3454084	-0.342119065	-0.35465971	-0.364184549	-0.365854464	-0.368151399	-0.372525128	-0.377386134	-0.382166479	-0.38358385	-0.378426528	-0.372771128	-0.37227763	-0.376968865	-0.381187274	-0.385522052	-0.388809485	-0.383465723	-0.380051358	-0.386238251	-0.394132974	-0.400044909	-0.404686862	-0.411219971	-0.417808053	-0.424942444	-0.436550005	-0.451072392	-0.460730359	-0.47132463	-0.485948929	-0.499093718	-0.513493077	-0.528108546	-0.541202914	-0.554526045	-0.569111482	-0.580900275	-0.589886127	-0.599245872	-0.615326031	-0.634162267	-0.648152241	-0.661127268	-0.672664849	-0.68331011	-0.697116357	-0.710948355	-0.719077087	-0.71911438	-0.721449764	-0.736759778	-0.754362971	-0.770767926	-0.789130039	-0.80601477	-0.821191128	-0.832929705	-0.841152228	-0.85933556	-0.880228361	-0.892233563	-0.903960412	-0.913700084	-0.919932207	-0.92639676	-0.93527688	-0.94303346	-0.94762044	-0.95069843	-0.95119214	-0.9576636	-0.963458	-0.96214829	-0.95636781	-0.94950125	-0.95753327	-0.975601654	-0.989785514	-1.003405333	-1.012051132	-1.013435813	-1.015786584	-1.018599741	-1.01833266	-1.01236391	-1.003750303	-0.995114358	-0.986457113	-0.977777721	-0.969073324	-0.960346111	-0.951598327	-0.942829704	-0.934039961	-0.925228827	-0.916396014	-0.90754123	-0.898664187	-0.890292817	-0.882957433	-0.876132694	-0.869290894	-0.862431784	-0.855555154	-0.848660744	-0.841748334	-0.834817645	-0.827868445	-0.820599662	-0.812707934	-0.804490743	-0.796247711	-0.78797841	-0.779682409	-0.771359268	-0.763008527	-0.754629696	-0.746222285	-0.737474398	-0.728070979	-0.718318734	-0.708527328	-0.698695963	-0.688823798	-0.678909993	-0.668953668	-0.658953923	-0.648909818	-0.639894686	-0.63298802	-0.627122907	-0.621226513	-0.61529829	-0.609337657	-0.603344043	-0.59731684	-0.591255417	-0.585159134	-0.579277044	-0.573859554	-0.568658118	-0.563422861	-0.558153155	-0.552848369	-0.547507832	-0.542130876	-0.536716789	-0.531264873	-0.526029137	-0.52126515	-0.516719433	-0.512137017	-0.5075172	-0.502859253	-0.498162436	-0.49342597	-0.488649073	-0.483830916	-0.479956927	-0.478028281	-0.477079243	-0.476128744	-0.475176746	-0.474223267	-0.473268299	-0.47231183	-0.471353862	-0.470394373	-0.46943793	-0.468488977	-0.467542939	-0.466595231	-0.465645873	-0.464694836	-0.463742138	-0.46278773	-0.461831652	-0.460873864	-0.46015457	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596];

lambda = [0.5 1.3]; %0.5-1.3  m²K/W
kappa = [0.2 1]; % 0.2-1 W/m²K
c = 4186; % J/kgK
rho = 1020; % kg/m³ 
h = 50; % m
C1 = c * h * rho * 3.16887646e-8; % W yr /m²K
d = 2000; % m
C2 = c * d * rho * 3.16887646e-8; % W yr /m²K

k = 100;

s = 1; 
RF = s * totRadForcAerosols + totRadForcExclCO2AndAerosols + CO2RadForc;

% RF = 1:k;
RF = @(t) 1;
tt = 1:10000;
i = 1;
for s = 1:2
    for n = 1:2
        d_delta_T1 = @(t, delta_T) 1/C1 * (RF(t) - delta_T(1) / lambda(n) - kappa(s) * (delta_T(1) - delta_T(2)));
        d_delta_T2 = @(t, delta_T) 1/C2 * kappa(s) * (delta_T(1) - delta_T(2));
        d_delta_T = @(t, delta_T) [d_delta_T1(t, delta_T); d_delta_T2(t, delta_T)];

        delta_T = zeros(2, length(tt));
        for t = 1:length(tt)-1
            delta_T(:, t+1) = delta_T(:,t) + d_delta_T(t, delta_T(:,t));
        end

        subplot(2,2,i)
        
        plot(tt, delta_T(1,:), 'DisplayName', '\Delta T1')
        hold on
        plot(tt, delta_T(2,:), 'DisplayName', '\Delta T2')
        title(['\kappa = ',num2str(kappa(s)), ', \lambda = ', num2str(lambda(n))])
        legend('Location','southeast')
        axis([0 10000 0 1.5])
        xlabel('Year')%, ylabel('Radiative forcing')
        i=i+1;
    end
end



% diff = delta_T(1,2:end)-delta_T(2,2:end);
% find(abs(diff)<=1e-4, 1, 'first') % runt år 6000 m. lambda=0.8
% find(delta_T(1,2:end) >= (1 - exp(-1))*lambda * 1, 1, 'first')
% find(delta_T(2,2:end) >= (1 - exp(-1))*lambda * 1, 1, 'first')

%% uppgift 10 c
clear, clc, clf

totRadForcExclCO2AndAerosols	= [0	0.115653444	0.251852421	0.256772281	0.21894257	0.218662979	0.259240629	0.274128052	0.263715683	0.249641179	0.238842165	0.24516418	0.272219646	0.302402384	0.310191962	0.302471248	0.293277521	0.249428376	0.132442595	0.04546089	0.115843943	0.2409541	0.302228607	0.308758611	0.195824757	0.031526544	0.049079212	0.172332524	0.23218477	0.22747827	0.190773442	0.177218677	0.192953549	0.207144648	0.213703669	0.23042582	0.251730578	0.248292338	0.232695799	0.228873797	0.22688789	0.217079623	0.207049891	-0.288063492	-1.432583888	-1.835225463	-1.039544299	-0.362618293	-0.161734092	-0.683174499	-2.146158602	-2.647045861	-1.477800511	-0.349345887	0.101159597	0.227302718	0.234152981	0.236913494	0.241604664	0.250046637	0.264208279	0.282755463	0.302280349	0.31267249	0.286334542	0.07059477	-0.321273268	-0.427595945	-0.135478426	-0.285498133	-0.886015654	-0.797080872	-0.182349169	0.193958939	0.30957468	0.290781286	0.267335976	0.267729314	0.240486098	0.234404641	0.283643618	0.334607869	0.371155547	0.398394488	0.382637532	0.342661444	0.334194749	0.338274987	0.333926336	0.325079597	0.184135622	-0.270701965	-0.504879886	-0.159822708	0.197818888	0.332032465	0.308787805	0.206705041	0.206849986	0.278889867	0.315133894	0.325931334	0.33742729	0.363518892	0.395412426	0.422015857	0.426645026	0.395538269	0.35406617	0.336504589	0.309899989	0.259123863	0.252376955	0.284053268	0.314109429	0.349503923	0.377269521	0.278831575	-0.629717546	-1.373927045	-0.800080887	-0.323770859	-0.207057768	-0.100691462	-0.167355374	-0.206323788	-0.105892434	0.09628362	0.266655774	0.386777178	0.36677811	0.196555121	0.095979808	0.190147272	0.298552342	0.344506769	0.327173489	-0.113790262	-0.474166121	-0.152451355	0.212517922	0.316817217	0.297380813	0.309295553	0.367502712	0.386955244	0.384655847	0.142469828	0.044747057	0.283698513	0.43263847	0.504926821	0.539494712	0.544118701	0.513536131	0.405936135	0.37234803	0.447712685	0.47375747	0.479011799	0.508073244	0.547260979	0.564197508	0.514129624	0.459999959	0.48207783	0.494661458	0.447371348	0.45119702	0.509172645	0.562700164	0.619237352	0.631705145	0.611896493	0.610231628	0.625996601	0.626160414	0.589091869	0.571990642	0.608405371	0.654051893	0.694977724	0.720413015	0.742174692	0.728470769	0.69787577	0.666187529	0.637413808	0.624309607	0.639054306	0.702878524	0.789673585	0.861303922	0.878147945	0.862438037	0.770080682	0.643959431	0.544238987	0.064992161	-0.278618322	0.069158369	0.49375619	0.667011447	0.504176985	0.457439657	0.71169703	0.889341414	0.944017858	0.901528461	0.753531286	0.664636749	0.81866331	1.030431828	1.093936205	1.155776228	1.25472466	1.195712861	0.497982973	0.181685802	0.709800594	0.992174407	1.06624936	1.13962008	1.25615126	1.35861424	1.38598613	0.43002636	-0.20014154	0.5062205	1.02436749	1.19750461	1.26318155	1.32400737	1.418781354	1.512371514	1.566890933	1.584131132	1.573295813	1.536130684	1.497623741	1.42695926	1.29936181	1.224840503	1.221944658	1.272839613	1.350555721	1.389231524	1.402708811	1.390630427	1.350778504	1.310808261	1.288179927	1.276313914	1.26967103	1.267795187	1.319478017	1.397457733	1.436743594	1.450574994	1.438350984	1.398344554	1.357997044	1.334769334	1.322080745	1.314395545	1.310843062	1.360610934	1.436521243	1.472789511	1.48302551	1.467023409	1.423019968	1.378434527	1.350708396	1.333247185	1.320505198	1.311604279	1.355316334	1.424985028	1.455426263	1.459961498	1.438460293	1.389217168	1.339695623	1.307369318	1.285714786	1.26925592	1.257008107	1.298085813	1.36586909	1.394717557	1.397900543	1.37524554	1.325016217	1.274657634	1.241623544	1.219327054	1.202204318	1.189352461	1.229955555	1.297340469	1.325853632	1.328751876	1.305852089	1.255408973	1.204860137	1.17165475	1.149174933	1.131847317	1.1187913	1.159193753	1.226381036	1.25469927	1.257413373	1.234409816	1.183990427	1.133570781	1.101464943	1.081181544	1.066382546	1.056155067	1.099652799	1.17017423	1.202040762	1.208483473	1.18929603	1.142711377	1.096144839	1.067025631	1.048747173	1.035751036	1.027145138	1.07210183	1.143937052	1.176987664	1.18449907	1.166279496	1.120835296	1.075637496	1.047901096	1.031012396	1.019407396	1.012189196	1.058526396	1.131732296	1.166141396	1.174995996	1.158099496	1.113693996	1.069204696	1.042069596	1.025689196	1.014511196	1.007649196	1.054280796	1.127727396	1.162329996	1.171336296	1.154554796	1.110232096	1.065799896	1.038699096	1.022329696	1.011141996	1.004251996	1.050839596	1.124228096	1.158760896	1.167687396	1.150816996	1.106397396	1.061858296	1.034642096	1.018152896	1.006841996	0.999825696	1.046284496	1.119542296	1.153943296	1.162736696	1.145732496	1.101178296	1.056503996	1.029152196	1.045671396	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796];																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															
CO2RadForc	=[0	0.011049082	0.023246047	0.025605215	0.028057033	0.03055287	0.033093627	0.035705793	0.038397133	0.041160901	0.044009648	0.046979223	0.050067292	0.053202569	0.05628708	0.059234532	0.06201229	0.064664134	0.067271913	0.069921132	0.072693308	0.075631696	0.078703283	0.081821836	0.084889902	0.087836927	0.090660982	0.09339792	0.096060423	0.098642066	0.1011408	0.10356312	0.10591503	0.10819345	0.11039084	0.11250486	0.11454316	0.11651278	0.1184099	0.12022542	0.1219681	0.1236704	0.12533497	0.12690511	0.12830042	0.12946317	0.1304044	0.13119381	0.13190268	0.13259134	0.13331508	0.13409903	0.13491805	0.13571684	0.13643515	0.13702906	0.13750239	0.13789659	0.13825059	0.13859452	0.13895098	0.13932247	0.13969896	0.14007543	0.14045187	0.14082828	0.14054596	0.1385692	0.1356501	0.13282363	0.12999566	0.1271662	0.12433524	0.12244727	0.12197515	0.12197515	0.12244727	0.12386337	0.12575101	0.12810952	0.13140969	0.13470811	0.13753359	0.14082795	0.14412058	0.14694109	0.14976013	0.15210829	0.15445521	0.15727029	0.16008389	0.162896	0.16570665	0.16898372	0.17225908	0.17506481	0.17786907	0.18020493	0.18253957	0.18533992	0.18767253	0.1895378	0.19140242	0.19373219	0.19652669	0.19931973	0.2025763	0.20629582	0.21047702	0.21558294	0.22114773	0.22716948	0.23410923	0.24150205	0.24934541	0.25809794	0.26729609	0.27602009	0.28427149	0.29251018	0.29982345	0.30575788	0.31077419	0.31487495	0.31851727	0.32170241	0.32443091	0.32715801	0.32942964	0.33124617	0.33306208	0.33487737	0.33714553	0.34077243	0.34575562	0.35118677	0.35706406	0.36338651	0.36970149	0.37645901	0.38410722	0.39219378	0.3998202	0.4069878	0.41414581	0.42129426	0.42798755	0.43422682	0.44045882	0.44623943	0.45156962	0.45733777	0.46354294	0.46929869	0.47460598	0.48034937	0.48696871	0.49358042	0.49974374	0.50677828	0.51468174	0.52213573	0.52957874	0.53788518	0.54617941	0.55402496	0.56229357	0.5705501	0.57792673	0.5848599	0.59178409	0.59783591	0.60215445	0.60517523	0.60733189	0.60862547	0.60862547	0.60733189	0.60560671	0.6043125	0.60388103	0.6043125	0.60560671	0.60776302	0.6107804	0.61508782	0.62111239	0.62798987	0.63528723	0.64385931	0.65370065	0.66395102	0.67460724	0.68520067	0.69628068	0.7093687	0.72293323	0.73507442	0.74521338	0.75407365	0.76618156	0.7828982	0.79886038	0.81597004	0.83695475	0.85481939	0.86912845	0.89018132	0.91528331	0.93260715	0.94626302	0.96504571	0.9895882	1.0148272	1.0415665	1.0706749	1.0922769	1.1090268	1.131041	1.1557767	1.1790812	1.2025127	1.23094	1.2629696	1.289621	1.3103479	1.3279065	1.3409723	1.354375	1.3745818	1.400075	1.4241974	1.4491927	1.4810336	1.5106359	1.5327048	1.5559009	1.5854995	1.6175545	1.6467939	1.675125	1.7035227	1.7308597	1.7590634	1.7889061	1.8189254	1.8483587	1.8776554	1.9069846	1.9364166	1.9659683	1.995568	2.0251167	2.0545783	2.0839653	2.1132986	2.142503	2.1717034	2.2011892	2.231053	2.2613025	2.2919099	2.3227715	2.3537626	2.3848242	2.4159493	2.4471439	2.4781534	2.5088668	2.5395246	2.5702467	2.6010645	2.6319705	2.662877	2.6936716	2.7243024	2.7547673	2.7849151	2.8145156	2.8436248	2.87247	2.9011769	2.9297842	2.9582922	2.9866207	3.0146618	3.0423684	3.0693909	3.095422	3.1204161	3.1444232	3.1676809	3.1903291	3.2124211	3.2339723	3.2549163	3.2751546	3.2944862	3.3127723	3.3300499	3.3462466	3.3614003	3.3757368	3.3893909	3.4024123	3.4148148	3.4265291	3.4372972	3.4469269	3.4554329	3.4628368	3.4690594	3.4741267	3.4782569	3.4815823	3.4841511	3.4859786	3.4876965	3.4898332	3.4922482	3.4948901	3.4977254	3.5006277	3.5035829	3.5067763	3.5103153	3.5142262	3.5185	3.5230427	3.5277246	3.5324729	3.5372666	3.5421013	3.546871	3.551578	3.5564214	3.5615212	3.5666508	3.5715667	3.5762077	3.5804644	3.5842837	3.5876611	3.5906065	3.5930255	3.5949304	3.5965304	3.5980276	3.5995347	3.6010524	3.6024967	3.6037448	3.6047301	3.6054375	3.605868	3.605919	3.6055958	3.6052119	3.6049934	3.6049722	3.6051476	3.6054302	3.6056931	3.6058657	3.6059297	3.605883	3.6056196	3.6051589	3.6047192	3.6044236	3.6043129	3.6043903	3.6045701	3.6047277	3.6047946	3.6047542	3.6046058	3.6042426	3.6036662	3.6030813	3.6026139	3.6023072	3.6021664	3.602107	3.6020055	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319];

totRadForcAerosols =	[0	-0.000675976	-0.002066998	-0.003506856	-0.004954363	-0.006391459	-0.008191986	-0.009976755	-0.011356966	-0.01270254	-0.014012763	-0.015287343	-0.016526278	-0.017729763	-0.018898132	-0.02003182	-0.021567991	-0.02307257	-0.024109188	-0.025112828	-0.026084191	-0.027023976	-0.02793288	-0.028811597	-0.029660819	-0.030481228	-0.031720164	-0.032931794	-0.033670013	-0.034381886	-0.035068072	-0.035729227	-0.036812009	-0.037870688	-0.038459809	-0.03947085	-0.040459338	-0.041867498	-0.042811099	-0.042847477	-0.04330705	-0.044187553	-0.045048591	-0.045450548	-0.045834932	-0.046202307	-0.046988661	-0.047758107	-0.04807573	-0.048378481	-0.049097878	-0.050231969	-0.051347739	-0.052018673	-0.052247777	-0.052465008	-0.052670881	-0.053287704	-0.054313124	-0.054904197	-0.055481569	-0.056048603	-0.056602739	-0.05714743	-0.057268842	-0.05983842	-0.061985112	-0.061662785	-0.062147465	-0.062625217	-0.063093126	-0.065149588	-0.066793151	-0.067226829	-0.06804864	-0.069251536	-0.070443016	-0.071619434	-0.072785088	-0.073936271	-0.076219158	-0.077724999	-0.078830357	-0.080304988	-0.081760072	-0.084206384	-0.085329759	-0.089862367	-0.094906246	-0.098208447	-0.101393282	-0.103266545	-0.105317054	-0.105997353	-0.107968928	-0.116387795	-0.128866385	-0.128795571	-0.125485166	-0.127995847	-0.132042374	-0.140424334	-0.14928997	-0.152486062	-0.151234006	-0.151466987	-0.160402206	-0.179061449	-0.1947542	-0.198352789	-0.198586719	-0.197983873	-0.193504655	-0.191345908	-0.195208839	-0.207646903	-0.215360381	-0.215031415	-0.218087204	-0.220358535	-0.218681403	-0.217795601	-0.220931602	-0.230782424	-0.235671466	-0.238864492	-0.246706766	-0.25198686	-0.255718184	-0.259476638	-0.26487402	-0.268523461	-0.269959278	-0.272220372	-0.276317622	-0.280935729	-0.285747379	-0.291266474	-0.298904499	-0.305709	-0.311545922	-0.319294997	-0.327701203	-0.329640603	-0.329068552	-0.334182054	-0.337618907	-0.338824198	-0.342313677	-0.342011793	-0.33936144	-0.342798461	-0.347957672	-0.350867581	-0.347516451	-0.347677775	-0.3454084	-0.342119065	-0.35465971	-0.364184549	-0.365854464	-0.368151399	-0.372525128	-0.377386134	-0.382166479	-0.38358385	-0.378426528	-0.372771128	-0.37227763	-0.376968865	-0.381187274	-0.385522052	-0.388809485	-0.383465723	-0.380051358	-0.386238251	-0.394132974	-0.400044909	-0.404686862	-0.411219971	-0.417808053	-0.424942444	-0.436550005	-0.451072392	-0.460730359	-0.47132463	-0.485948929	-0.499093718	-0.513493077	-0.528108546	-0.541202914	-0.554526045	-0.569111482	-0.580900275	-0.589886127	-0.599245872	-0.615326031	-0.634162267	-0.648152241	-0.661127268	-0.672664849	-0.68331011	-0.697116357	-0.710948355	-0.719077087	-0.71911438	-0.721449764	-0.736759778	-0.754362971	-0.770767926	-0.789130039	-0.80601477	-0.821191128	-0.832929705	-0.841152228	-0.85933556	-0.880228361	-0.892233563	-0.903960412	-0.913700084	-0.919932207	-0.92639676	-0.93527688	-0.94303346	-0.94762044	-0.95069843	-0.95119214	-0.9576636	-0.963458	-0.96214829	-0.95636781	-0.94950125	-0.95753327	-0.975601654	-0.989785514	-1.003405333	-1.012051132	-1.013435813	-1.015786584	-1.018599741	-1.01833266	-1.01236391	-1.003750303	-0.995114358	-0.986457113	-0.977777721	-0.969073324	-0.960346111	-0.951598327	-0.942829704	-0.934039961	-0.925228827	-0.916396014	-0.90754123	-0.898664187	-0.890292817	-0.882957433	-0.876132694	-0.869290894	-0.862431784	-0.855555154	-0.848660744	-0.841748334	-0.834817645	-0.827868445	-0.820599662	-0.812707934	-0.804490743	-0.796247711	-0.78797841	-0.779682409	-0.771359268	-0.763008527	-0.754629696	-0.746222285	-0.737474398	-0.728070979	-0.718318734	-0.708527328	-0.698695963	-0.688823798	-0.678909993	-0.668953668	-0.658953923	-0.648909818	-0.639894686	-0.63298802	-0.627122907	-0.621226513	-0.61529829	-0.609337657	-0.603344043	-0.59731684	-0.591255417	-0.585159134	-0.579277044	-0.573859554	-0.568658118	-0.563422861	-0.558153155	-0.552848369	-0.547507832	-0.542130876	-0.536716789	-0.531264873	-0.526029137	-0.52126515	-0.516719433	-0.512137017	-0.5075172	-0.502859253	-0.498162436	-0.49342597	-0.488649073	-0.483830916	-0.479956927	-0.478028281	-0.477079243	-0.476128744	-0.475176746	-0.474223267	-0.473268299	-0.47231183	-0.471353862	-0.470394373	-0.46943793	-0.468488977	-0.467542939	-0.466595231	-0.465645873	-0.464694836	-0.463742138	-0.46278773	-0.461831652	-0.460873864	-0.46015457	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596];

lambda = [0.5 1.3]; %0.5-1.3  m²K/W
kappa = [0.2 1]; % 0.2-1 W/m²K
c = 4186; % J/kgK
rho = 1020; % kg/m³ 
h = 50; % m
C1 = c * h * rho * 3.16887646e-8; % W yr /m²K
d = 2000; % m
C2 = c * d * rho * 3.16887646e-8; % W yr /m²K

% RF = 1:k;
RF = @(t) 1;
tt = 1:200;
i = 1;
for s = 1:2
    for n = 1:2
        d_delta_T1 = @(t, delta_T) 1/C1 * (RF(t) - delta_T(1) / lambda(n) - kappa(s) * (delta_T(1) - delta_T(2)));
        d_delta_T2 = @(t, delta_T) 1/C2 * kappa(s) * (delta_T(1) - delta_T(2));
        d_delta_T = @(t, delta_T) [d_delta_T1(t, delta_T); d_delta_T2(t, delta_T)];

        delta_T = zeros(2, length(tt));
        for t = 1:length(tt)-1
            delta_T(:, t+1) = delta_T(:,t) + d_delta_T(t, delta_T(:,t));
        end

        subplot(2,2,i)
        
        deepsea = kappa(s) * (delta_T(1,:) - delta_T(2,:));
        space = delta_T(1,:) / lambda(n);
        plot(tt, deepsea, 'DisplayName', ' Deep Sea')
        hold on
        plot(tt, space, 'DisplayName', 'Space')
        title(['\kappa = ',num2str(kappa(s)), ', \lambda = ', num2str(lambda(n))])
        legend('Location','east')
        xlabel('Year'), ylabel('Energy flow')
        axis([0 200 0 1])
       
        i=i+1;
    end
end
legend('Location','southeast')

%% del 3 upg 11
clc, clear, clf

%Parametrar
F = [0 60 0; 15 0 45; 45 0 0]; %GtC
NPP0 = F(1,2);
beta = 0.28; %Kan variera mellan 0.1 och 0.8
B0 = [600 600 1500]; %GtC
A = [0.113 0.213 0.258 0.273 0.1430];
tao_0 = [2.0 12.2 50.4 243.3 Inf];
k = 3.06*1e-3;
M0 = 600;
global CO2Emissions;
global CO2ConcRCP45;

%Nettoprimärproduktion av biomassa (fotosyntes)
NPP = @(B) NPP0*(1+beta*log(B(1)/B0(1)));

%Flödeskoefficienter
alpha = @(i,j) F(i,j)/B0(i);

% Differentialekvationer
% B är en 1x3 vektor
dB1 = @(B,t) alpha(3,1)*B(3) + alpha(2,1)*B(2) - NPP(B) + CO2Emissions(t);
dB2 = @(B,t) NPP(B) - alpha(2,3)*B(2) - alpha(2,1)*B(2);
dB3 = @(B,t) alpha(2,3)*B(2) - alpha(3,1)*B(3);
dB = @(B,t) [dB1(B,t); dB2(B,t); dB3(B,t)];

% -- lösning --
B = zeros(3, length(CO2Emissions));    % 3 x 736 matris för alla B
B(:, 1) = B0(:);    % sätt startvärden
emissions = zeros(1, length(CO2Emissions));
for t = 1:length(CO2Emissions)-1   % 1:735
    M = M0;
    for t_tilde = 1:t                
        I = sum(A' .* exp(-(t-t_tilde) ./ (tao_0*(1+k*emissions(t)))'));
        M = M + I * dB1(B(:, t_tilde), t_tilde);
    end

    B(:, t+1) = B(:, t) + dB(B(:, t), t);

    % kumulativa utsläpp (utan haven)
    emissions(t+1) = emissions(t) + dB1(B(:, t), t);

    % B1 med haven
    B(1, t+1) = M;
end

% Koncentrationerna
conc = 0.469 * B(1,:); %ppm C02


totRadForcExclCO2AndAerosols	= [0	0.115653444	0.251852421	0.256772281	0.21894257	0.218662979	0.259240629	0.274128052	0.263715683	0.249641179	0.238842165	0.24516418	0.272219646	0.302402384	0.310191962	0.302471248	0.293277521	0.249428376	0.132442595	0.04546089	0.115843943	0.2409541	0.302228607	0.308758611	0.195824757	0.031526544	0.049079212	0.172332524	0.23218477	0.22747827	0.190773442	0.177218677	0.192953549	0.207144648	0.213703669	0.23042582	0.251730578	0.248292338	0.232695799	0.228873797	0.22688789	0.217079623	0.207049891	-0.288063492	-1.432583888	-1.835225463	-1.039544299	-0.362618293	-0.161734092	-0.683174499	-2.146158602	-2.647045861	-1.477800511	-0.349345887	0.101159597	0.227302718	0.234152981	0.236913494	0.241604664	0.250046637	0.264208279	0.282755463	0.302280349	0.31267249	0.286334542	0.07059477	-0.321273268	-0.427595945	-0.135478426	-0.285498133	-0.886015654	-0.797080872	-0.182349169	0.193958939	0.30957468	0.290781286	0.267335976	0.267729314	0.240486098	0.234404641	0.283643618	0.334607869	0.371155547	0.398394488	0.382637532	0.342661444	0.334194749	0.338274987	0.333926336	0.325079597	0.184135622	-0.270701965	-0.504879886	-0.159822708	0.197818888	0.332032465	0.308787805	0.206705041	0.206849986	0.278889867	0.315133894	0.325931334	0.33742729	0.363518892	0.395412426	0.422015857	0.426645026	0.395538269	0.35406617	0.336504589	0.309899989	0.259123863	0.252376955	0.284053268	0.314109429	0.349503923	0.377269521	0.278831575	-0.629717546	-1.373927045	-0.800080887	-0.323770859	-0.207057768	-0.100691462	-0.167355374	-0.206323788	-0.105892434	0.09628362	0.266655774	0.386777178	0.36677811	0.196555121	0.095979808	0.190147272	0.298552342	0.344506769	0.327173489	-0.113790262	-0.474166121	-0.152451355	0.212517922	0.316817217	0.297380813	0.309295553	0.367502712	0.386955244	0.384655847	0.142469828	0.044747057	0.283698513	0.43263847	0.504926821	0.539494712	0.544118701	0.513536131	0.405936135	0.37234803	0.447712685	0.47375747	0.479011799	0.508073244	0.547260979	0.564197508	0.514129624	0.459999959	0.48207783	0.494661458	0.447371348	0.45119702	0.509172645	0.562700164	0.619237352	0.631705145	0.611896493	0.610231628	0.625996601	0.626160414	0.589091869	0.571990642	0.608405371	0.654051893	0.694977724	0.720413015	0.742174692	0.728470769	0.69787577	0.666187529	0.637413808	0.624309607	0.639054306	0.702878524	0.789673585	0.861303922	0.878147945	0.862438037	0.770080682	0.643959431	0.544238987	0.064992161	-0.278618322	0.069158369	0.49375619	0.667011447	0.504176985	0.457439657	0.71169703	0.889341414	0.944017858	0.901528461	0.753531286	0.664636749	0.81866331	1.030431828	1.093936205	1.155776228	1.25472466	1.195712861	0.497982973	0.181685802	0.709800594	0.992174407	1.06624936	1.13962008	1.25615126	1.35861424	1.38598613	0.43002636	-0.20014154	0.5062205	1.02436749	1.19750461	1.26318155	1.32400737	1.418781354	1.512371514	1.566890933	1.584131132	1.573295813	1.536130684	1.497623741	1.42695926	1.29936181	1.224840503	1.221944658	1.272839613	1.350555721	1.389231524	1.402708811	1.390630427	1.350778504	1.310808261	1.288179927	1.276313914	1.26967103	1.267795187	1.319478017	1.397457733	1.436743594	1.450574994	1.438350984	1.398344554	1.357997044	1.334769334	1.322080745	1.314395545	1.310843062	1.360610934	1.436521243	1.472789511	1.48302551	1.467023409	1.423019968	1.378434527	1.350708396	1.333247185	1.320505198	1.311604279	1.355316334	1.424985028	1.455426263	1.459961498	1.438460293	1.389217168	1.339695623	1.307369318	1.285714786	1.26925592	1.257008107	1.298085813	1.36586909	1.394717557	1.397900543	1.37524554	1.325016217	1.274657634	1.241623544	1.219327054	1.202204318	1.189352461	1.229955555	1.297340469	1.325853632	1.328751876	1.305852089	1.255408973	1.204860137	1.17165475	1.149174933	1.131847317	1.1187913	1.159193753	1.226381036	1.25469927	1.257413373	1.234409816	1.183990427	1.133570781	1.101464943	1.081181544	1.066382546	1.056155067	1.099652799	1.17017423	1.202040762	1.208483473	1.18929603	1.142711377	1.096144839	1.067025631	1.048747173	1.035751036	1.027145138	1.07210183	1.143937052	1.176987664	1.18449907	1.166279496	1.120835296	1.075637496	1.047901096	1.031012396	1.019407396	1.012189196	1.058526396	1.131732296	1.166141396	1.174995996	1.158099496	1.113693996	1.069204696	1.042069596	1.025689196	1.014511196	1.007649196	1.054280796	1.127727396	1.162329996	1.171336296	1.154554796	1.110232096	1.065799896	1.038699096	1.022329696	1.011141996	1.004251996	1.050839596	1.124228096	1.158760896	1.167687396	1.150816996	1.106397396	1.061858296	1.034642096	1.018152896	1.006841996	0.999825696	1.046284496	1.119542296	1.153943296	1.162736696	1.145732496	1.101178296	1.056503996	1.029152196	1.045671396	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796];																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															
CO2RadForc	=[0	0.011049082	0.023246047	0.025605215	0.028057033	0.03055287	0.033093627	0.035705793	0.038397133	0.041160901	0.044009648	0.046979223	0.050067292	0.053202569	0.05628708	0.059234532	0.06201229	0.064664134	0.067271913	0.069921132	0.072693308	0.075631696	0.078703283	0.081821836	0.084889902	0.087836927	0.090660982	0.09339792	0.096060423	0.098642066	0.1011408	0.10356312	0.10591503	0.10819345	0.11039084	0.11250486	0.11454316	0.11651278	0.1184099	0.12022542	0.1219681	0.1236704	0.12533497	0.12690511	0.12830042	0.12946317	0.1304044	0.13119381	0.13190268	0.13259134	0.13331508	0.13409903	0.13491805	0.13571684	0.13643515	0.13702906	0.13750239	0.13789659	0.13825059	0.13859452	0.13895098	0.13932247	0.13969896	0.14007543	0.14045187	0.14082828	0.14054596	0.1385692	0.1356501	0.13282363	0.12999566	0.1271662	0.12433524	0.12244727	0.12197515	0.12197515	0.12244727	0.12386337	0.12575101	0.12810952	0.13140969	0.13470811	0.13753359	0.14082795	0.14412058	0.14694109	0.14976013	0.15210829	0.15445521	0.15727029	0.16008389	0.162896	0.16570665	0.16898372	0.17225908	0.17506481	0.17786907	0.18020493	0.18253957	0.18533992	0.18767253	0.1895378	0.19140242	0.19373219	0.19652669	0.19931973	0.2025763	0.20629582	0.21047702	0.21558294	0.22114773	0.22716948	0.23410923	0.24150205	0.24934541	0.25809794	0.26729609	0.27602009	0.28427149	0.29251018	0.29982345	0.30575788	0.31077419	0.31487495	0.31851727	0.32170241	0.32443091	0.32715801	0.32942964	0.33124617	0.33306208	0.33487737	0.33714553	0.34077243	0.34575562	0.35118677	0.35706406	0.36338651	0.36970149	0.37645901	0.38410722	0.39219378	0.3998202	0.4069878	0.41414581	0.42129426	0.42798755	0.43422682	0.44045882	0.44623943	0.45156962	0.45733777	0.46354294	0.46929869	0.47460598	0.48034937	0.48696871	0.49358042	0.49974374	0.50677828	0.51468174	0.52213573	0.52957874	0.53788518	0.54617941	0.55402496	0.56229357	0.5705501	0.57792673	0.5848599	0.59178409	0.59783591	0.60215445	0.60517523	0.60733189	0.60862547	0.60862547	0.60733189	0.60560671	0.6043125	0.60388103	0.6043125	0.60560671	0.60776302	0.6107804	0.61508782	0.62111239	0.62798987	0.63528723	0.64385931	0.65370065	0.66395102	0.67460724	0.68520067	0.69628068	0.7093687	0.72293323	0.73507442	0.74521338	0.75407365	0.76618156	0.7828982	0.79886038	0.81597004	0.83695475	0.85481939	0.86912845	0.89018132	0.91528331	0.93260715	0.94626302	0.96504571	0.9895882	1.0148272	1.0415665	1.0706749	1.0922769	1.1090268	1.131041	1.1557767	1.1790812	1.2025127	1.23094	1.2629696	1.289621	1.3103479	1.3279065	1.3409723	1.354375	1.3745818	1.400075	1.4241974	1.4491927	1.4810336	1.5106359	1.5327048	1.5559009	1.5854995	1.6175545	1.6467939	1.675125	1.7035227	1.7308597	1.7590634	1.7889061	1.8189254	1.8483587	1.8776554	1.9069846	1.9364166	1.9659683	1.995568	2.0251167	2.0545783	2.0839653	2.1132986	2.142503	2.1717034	2.2011892	2.231053	2.2613025	2.2919099	2.3227715	2.3537626	2.3848242	2.4159493	2.4471439	2.4781534	2.5088668	2.5395246	2.5702467	2.6010645	2.6319705	2.662877	2.6936716	2.7243024	2.7547673	2.7849151	2.8145156	2.8436248	2.87247	2.9011769	2.9297842	2.9582922	2.9866207	3.0146618	3.0423684	3.0693909	3.095422	3.1204161	3.1444232	3.1676809	3.1903291	3.2124211	3.2339723	3.2549163	3.2751546	3.2944862	3.3127723	3.3300499	3.3462466	3.3614003	3.3757368	3.3893909	3.4024123	3.4148148	3.4265291	3.4372972	3.4469269	3.4554329	3.4628368	3.4690594	3.4741267	3.4782569	3.4815823	3.4841511	3.4859786	3.4876965	3.4898332	3.4922482	3.4948901	3.4977254	3.5006277	3.5035829	3.5067763	3.5103153	3.5142262	3.5185	3.5230427	3.5277246	3.5324729	3.5372666	3.5421013	3.546871	3.551578	3.5564214	3.5615212	3.5666508	3.5715667	3.5762077	3.5804644	3.5842837	3.5876611	3.5906065	3.5930255	3.5949304	3.5965304	3.5980276	3.5995347	3.6010524	3.6024967	3.6037448	3.6047301	3.6054375	3.605868	3.605919	3.6055958	3.6052119	3.6049934	3.6049722	3.6051476	3.6054302	3.6056931	3.6058657	3.6059297	3.605883	3.6056196	3.6051589	3.6047192	3.6044236	3.6043129	3.6043903	3.6045701	3.6047277	3.6047946	3.6047542	3.6046058	3.6042426	3.6036662	3.6030813	3.6026139	3.6023072	3.6021664	3.602107	3.6020055	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319];

totRadForcAerosols =	[0	-0.000675976	-0.002066998	-0.003506856	-0.004954363	-0.006391459	-0.008191986	-0.009976755	-0.011356966	-0.01270254	-0.014012763	-0.015287343	-0.016526278	-0.017729763	-0.018898132	-0.02003182	-0.021567991	-0.02307257	-0.024109188	-0.025112828	-0.026084191	-0.027023976	-0.02793288	-0.028811597	-0.029660819	-0.030481228	-0.031720164	-0.032931794	-0.033670013	-0.034381886	-0.035068072	-0.035729227	-0.036812009	-0.037870688	-0.038459809	-0.03947085	-0.040459338	-0.041867498	-0.042811099	-0.042847477	-0.04330705	-0.044187553	-0.045048591	-0.045450548	-0.045834932	-0.046202307	-0.046988661	-0.047758107	-0.04807573	-0.048378481	-0.049097878	-0.050231969	-0.051347739	-0.052018673	-0.052247777	-0.052465008	-0.052670881	-0.053287704	-0.054313124	-0.054904197	-0.055481569	-0.056048603	-0.056602739	-0.05714743	-0.057268842	-0.05983842	-0.061985112	-0.061662785	-0.062147465	-0.062625217	-0.063093126	-0.065149588	-0.066793151	-0.067226829	-0.06804864	-0.069251536	-0.070443016	-0.071619434	-0.072785088	-0.073936271	-0.076219158	-0.077724999	-0.078830357	-0.080304988	-0.081760072	-0.084206384	-0.085329759	-0.089862367	-0.094906246	-0.098208447	-0.101393282	-0.103266545	-0.105317054	-0.105997353	-0.107968928	-0.116387795	-0.128866385	-0.128795571	-0.125485166	-0.127995847	-0.132042374	-0.140424334	-0.14928997	-0.152486062	-0.151234006	-0.151466987	-0.160402206	-0.179061449	-0.1947542	-0.198352789	-0.198586719	-0.197983873	-0.193504655	-0.191345908	-0.195208839	-0.207646903	-0.215360381	-0.215031415	-0.218087204	-0.220358535	-0.218681403	-0.217795601	-0.220931602	-0.230782424	-0.235671466	-0.238864492	-0.246706766	-0.25198686	-0.255718184	-0.259476638	-0.26487402	-0.268523461	-0.269959278	-0.272220372	-0.276317622	-0.280935729	-0.285747379	-0.291266474	-0.298904499	-0.305709	-0.311545922	-0.319294997	-0.327701203	-0.329640603	-0.329068552	-0.334182054	-0.337618907	-0.338824198	-0.342313677	-0.342011793	-0.33936144	-0.342798461	-0.347957672	-0.350867581	-0.347516451	-0.347677775	-0.3454084	-0.342119065	-0.35465971	-0.364184549	-0.365854464	-0.368151399	-0.372525128	-0.377386134	-0.382166479	-0.38358385	-0.378426528	-0.372771128	-0.37227763	-0.376968865	-0.381187274	-0.385522052	-0.388809485	-0.383465723	-0.380051358	-0.386238251	-0.394132974	-0.400044909	-0.404686862	-0.411219971	-0.417808053	-0.424942444	-0.436550005	-0.451072392	-0.460730359	-0.47132463	-0.485948929	-0.499093718	-0.513493077	-0.528108546	-0.541202914	-0.554526045	-0.569111482	-0.580900275	-0.589886127	-0.599245872	-0.615326031	-0.634162267	-0.648152241	-0.661127268	-0.672664849	-0.68331011	-0.697116357	-0.710948355	-0.719077087	-0.71911438	-0.721449764	-0.736759778	-0.754362971	-0.770767926	-0.789130039	-0.80601477	-0.821191128	-0.832929705	-0.841152228	-0.85933556	-0.880228361	-0.892233563	-0.903960412	-0.913700084	-0.919932207	-0.92639676	-0.93527688	-0.94303346	-0.94762044	-0.95069843	-0.95119214	-0.9576636	-0.963458	-0.96214829	-0.95636781	-0.94950125	-0.95753327	-0.975601654	-0.989785514	-1.003405333	-1.012051132	-1.013435813	-1.015786584	-1.018599741	-1.01833266	-1.01236391	-1.003750303	-0.995114358	-0.986457113	-0.977777721	-0.969073324	-0.960346111	-0.951598327	-0.942829704	-0.934039961	-0.925228827	-0.916396014	-0.90754123	-0.898664187	-0.890292817	-0.882957433	-0.876132694	-0.869290894	-0.862431784	-0.855555154	-0.848660744	-0.841748334	-0.834817645	-0.827868445	-0.820599662	-0.812707934	-0.804490743	-0.796247711	-0.78797841	-0.779682409	-0.771359268	-0.763008527	-0.754629696	-0.746222285	-0.737474398	-0.728070979	-0.718318734	-0.708527328	-0.698695963	-0.688823798	-0.678909993	-0.668953668	-0.658953923	-0.648909818	-0.639894686	-0.63298802	-0.627122907	-0.621226513	-0.61529829	-0.609337657	-0.603344043	-0.59731684	-0.591255417	-0.585159134	-0.579277044	-0.573859554	-0.568658118	-0.563422861	-0.558153155	-0.552848369	-0.547507832	-0.542130876	-0.536716789	-0.531264873	-0.526029137	-0.52126515	-0.516719433	-0.512137017	-0.5075172	-0.502859253	-0.498162436	-0.49342597	-0.488649073	-0.483830916	-0.479956927	-0.478028281	-0.477079243	-0.476128744	-0.475176746	-0.474223267	-0.473268299	-0.47231183	-0.471353862	-0.470394373	-0.46943793	-0.468488977	-0.467542939	-0.466595231	-0.465645873	-0.464694836	-0.463742138	-0.46278773	-0.461831652	-0.460873864	-0.46015457	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596];

lambda = [0.5, 0.8, 1.3]; %0.5-1.3  m²K/W
kappa = [0.2 0.6 1]; % 0.2-1 W/m²K
s = [1, 1.2, 1.4]; 
c = 4186; % J/kgK
rho = 1020; % kg/m³ 
h = 50; % m
C1 = c * h * rho * 3.16887646e-8; % W yr /m²K
d = 2000; % m
C2 = c * d * rho * 3.16887646e-8; % W yr /m²K


p0_co2 = 0.469 * 600; % ppm CO2 / GtC
rf = @(p_co2) 5.35 * log(p_co2 ./ p0_co2);

T = 1765:2500;

for i = 1:3
    RF = s(i) * totRadForcAerosols + totRadForcExclCO2AndAerosols + rf(conc);
    
    d_delta_T1 = @(t, delta_T) 1/C1 * (RF(t) - delta_T(1) / lambda(i) - kappa(i) * (delta_T(1) - delta_T(2)));
    d_delta_T2 = @(t, delta_T) 1/C2 * kappa(i) * (delta_T(1) - delta_T(2));
    d_delta_T = @(t, delta_T) [d_delta_T1(t, delta_T); d_delta_T2(t, delta_T)];

    delta_T = zeros(2, length(T));
    for t = 1:length(T)-1
        delta_T(:, t+1) = delta_T(:,t) + d_delta_T(t, delta_T(:,t));
    end
    
    % From NASA, 1880-2019 
    TAnomali =	[-0.16 -0.08 -0.1 -0.17 -0.28 -0.32 -0.3 -0.35 -0.16 -0.1 -0.34 -0.21 -0.26 -0.31 -0.29 -0.22 -0.1 -0.1 -0.26 -0.17 -0.07 -0.15 -0.27 -0.37 -0.46 -0.26 -0.22 -0.38 -0.42 -0.48 -0.43 -0.44 -0.36 -0.34 -0.15 -0.14 -0.36 -0.46 -0.3 -0.28 -0.27 -0.19 -0.28 -0.27 -0.27 -0.22 -0.11 -0.22 -0.2 -0.36 -0.16 -0.09 -0.16 -0.29 -0.13 -0.2 -0.15 -0.03 -0.01 -0.02 0.13 0.18 0.07 0.09 0.2 0.09 -0.07 -0.03 -0.11 -0.11 -0.18 -0.07 0.01 0.08 -0.13 -0.14 -0.19 0.05 0.06 0.03 -0.02 0.06 0.04 0.05 -0.2 -0.11 -0.06 -0.02 -0.08 0.05 0.02 -0.08 0.01 0.16 -0.07 -0.01 -0.1 0.18 0.07 0.16 0.26 0.32 0.14 0.31 0.15 0.12 0.18 0.32 0.38 0.27 0.45 0.4 0.22 0.23 0.31 0.45 0.33 0.46 0.61 0.39 0.39 0.54 0.63 0.62 0.54 0.68 0.64 0.66 0.54 0.66 0.72 0.61 0.64 0.68 0.74 0.9 1.01 0.92 0.85 0.98];

    
    avg = mean(delta_T(1, 1951-1765:1980-1765));
    
    nasaT = 1880:2019;
    plot(nasaT, delta_T(1,1880-1765:2019-1765)-avg, 'DisplayName', ['\lambda = ', num2str(lambda(i)), ', \kappa = ', num2str(kappa(i)),', s = ', num2str(s(i))])
    hold on
end

plot(nasaT, TAnomali, 'DisplayName', 'Nasa')
legend('Location', 'southeast')
xlabel('Year'), ylabel('Temperature deviation')


%% del 3 upg 12
clc, clear, clf

%Parametrar
F = [0 60 0; 15 0 45; 45 0 0]; %GtC
NPP0 = F(1,2);
beta = 0.38; %Kan variera mellan 0.1 och 0.8
B0 = [600 600 1500]; %GtC
A = [0.113 0.213 0.258 0.273 0.1430];
tao_0 = [2.0 12.2 50.4 243.3 Inf];
k = 3.06*1e-3;
M0 = 600;
global CO2Emissions;
global CO2ConcRCP45;

CO2today = CO2Emissions(2021-1765);

scenario1 = [CO2Emissions(1:2021-1765-1), linspace(CO2today,0,49), zeros(1,130)];
scenario2 = [CO2Emissions(1:2021-1765-1), CO2today * ones(1,179)];
scenario3 = [CO2Emissions(1:2021-1765-1), linspace(CO2today,CO2today*2.5,79), CO2today*2.5*ones(1,100)];

CO2scenarios = [scenario1; scenario2; scenario3] %CO2Emissions(1:2200-1765-1)];

%Nettoprimärproduktion av biomassa (fotosyntes)
NPP = @(B) NPP0*(1+beta*log(B(1)/B0(1)));

%Flödeskoefficienter
alpha = @(i,j) F(i,j)/B0(i);
lambda = [0.5, 0.8, 1.3]; %0.5-1.3  m²K/W
kappa = [0.2 0.6 1]; % 0.2-1 W/m²K
s = [1, 1.2, 1.4]; 

for j = 1:3
    for i = 1:3
        U = CO2scenarios(i, :);
        % Differentialekvationer
        % B är en 1x3 vektor
        dB1 = @(B,t) alpha(3,1)*B(3) + alpha(2,1)*B(2) - NPP(B) + U(t);
        dB2 = @(B,t) NPP(B) - alpha(2,3)*B(2) - alpha(2,1)*B(2);
        dB3 = @(B,t) alpha(2,3)*B(2) - alpha(3,1)*B(3);
        dB = @(B,t) [dB1(B,t); dB2(B,t); dB3(B,t)];

        % -- lösning --
        B = zeros(3, length(U));    % 3 x 736 matris för alla B
        B(:, 1) = B0(:);    % sätt startvärden
        emissions = zeros(1, length(U));
        for t = 1:length(U)-1   % 1:735
            M = M0;
            for t_tilde = 1:t                
                I = sum(A' .* exp(-(t-t_tilde) ./ (tao_0*(1+k*emissions(t)))'));
                M = M + I * dB1(B(:, t_tilde), t_tilde);
            end

            B(:, t+1) = B(:, t) + dB(B(:, t), t);

            % kumulativa utsläpp (utan haven)
            emissions(t+1) = emissions(t) + dB1(B(:, t), t);

            % B1 med haven
            B(1, t+1) = M;
        end

        % Koncentrationerna
        conc = 0.469 * B(1,:); %ppm C02


        totRadForcExclCO2AndAerosols	= [0	0.115653444	0.251852421	0.256772281	0.21894257	0.218662979	0.259240629	0.274128052	0.263715683	0.249641179	0.238842165	0.24516418	0.272219646	0.302402384	0.310191962	0.302471248	0.293277521	0.249428376	0.132442595	0.04546089	0.115843943	0.2409541	0.302228607	0.308758611	0.195824757	0.031526544	0.049079212	0.172332524	0.23218477	0.22747827	0.190773442	0.177218677	0.192953549	0.207144648	0.213703669	0.23042582	0.251730578	0.248292338	0.232695799	0.228873797	0.22688789	0.217079623	0.207049891	-0.288063492	-1.432583888	-1.835225463	-1.039544299	-0.362618293	-0.161734092	-0.683174499	-2.146158602	-2.647045861	-1.477800511	-0.349345887	0.101159597	0.227302718	0.234152981	0.236913494	0.241604664	0.250046637	0.264208279	0.282755463	0.302280349	0.31267249	0.286334542	0.07059477	-0.321273268	-0.427595945	-0.135478426	-0.285498133	-0.886015654	-0.797080872	-0.182349169	0.193958939	0.30957468	0.290781286	0.267335976	0.267729314	0.240486098	0.234404641	0.283643618	0.334607869	0.371155547	0.398394488	0.382637532	0.342661444	0.334194749	0.338274987	0.333926336	0.325079597	0.184135622	-0.270701965	-0.504879886	-0.159822708	0.197818888	0.332032465	0.308787805	0.206705041	0.206849986	0.278889867	0.315133894	0.325931334	0.33742729	0.363518892	0.395412426	0.422015857	0.426645026	0.395538269	0.35406617	0.336504589	0.309899989	0.259123863	0.252376955	0.284053268	0.314109429	0.349503923	0.377269521	0.278831575	-0.629717546	-1.373927045	-0.800080887	-0.323770859	-0.207057768	-0.100691462	-0.167355374	-0.206323788	-0.105892434	0.09628362	0.266655774	0.386777178	0.36677811	0.196555121	0.095979808	0.190147272	0.298552342	0.344506769	0.327173489	-0.113790262	-0.474166121	-0.152451355	0.212517922	0.316817217	0.297380813	0.309295553	0.367502712	0.386955244	0.384655847	0.142469828	0.044747057	0.283698513	0.43263847	0.504926821	0.539494712	0.544118701	0.513536131	0.405936135	0.37234803	0.447712685	0.47375747	0.479011799	0.508073244	0.547260979	0.564197508	0.514129624	0.459999959	0.48207783	0.494661458	0.447371348	0.45119702	0.509172645	0.562700164	0.619237352	0.631705145	0.611896493	0.610231628	0.625996601	0.626160414	0.589091869	0.571990642	0.608405371	0.654051893	0.694977724	0.720413015	0.742174692	0.728470769	0.69787577	0.666187529	0.637413808	0.624309607	0.639054306	0.702878524	0.789673585	0.861303922	0.878147945	0.862438037	0.770080682	0.643959431	0.544238987	0.064992161	-0.278618322	0.069158369	0.49375619	0.667011447	0.504176985	0.457439657	0.71169703	0.889341414	0.944017858	0.901528461	0.753531286	0.664636749	0.81866331	1.030431828	1.093936205	1.155776228	1.25472466	1.195712861	0.497982973	0.181685802	0.709800594	0.992174407	1.06624936	1.13962008	1.25615126	1.35861424	1.38598613	0.43002636	-0.20014154	0.5062205	1.02436749	1.19750461	1.26318155	1.32400737	1.418781354	1.512371514	1.566890933	1.584131132	1.573295813	1.536130684	1.497623741	1.42695926	1.29936181	1.224840503	1.221944658	1.272839613	1.350555721	1.389231524	1.402708811	1.390630427	1.350778504	1.310808261	1.288179927	1.276313914	1.26967103	1.267795187	1.319478017	1.397457733	1.436743594	1.450574994	1.438350984	1.398344554	1.357997044	1.334769334	1.322080745	1.314395545	1.310843062	1.360610934	1.436521243	1.472789511	1.48302551	1.467023409	1.423019968	1.378434527	1.350708396	1.333247185	1.320505198	1.311604279	1.355316334	1.424985028	1.455426263	1.459961498	1.438460293	1.389217168	1.339695623	1.307369318	1.285714786	1.26925592	1.257008107	1.298085813	1.36586909	1.394717557	1.397900543	1.37524554	1.325016217	1.274657634	1.241623544	1.219327054	1.202204318	1.189352461	1.229955555	1.297340469	1.325853632	1.328751876	1.305852089	1.255408973	1.204860137	1.17165475	1.149174933	1.131847317	1.1187913	1.159193753	1.226381036	1.25469927	1.257413373	1.234409816	1.183990427	1.133570781	1.101464943	1.081181544	1.066382546	1.056155067	1.099652799	1.17017423	1.202040762	1.208483473	1.18929603	1.142711377	1.096144839	1.067025631	1.048747173	1.035751036	1.027145138	1.07210183	1.143937052	1.176987664	1.18449907	1.166279496	1.120835296	1.075637496	1.047901096	1.031012396	1.019407396	1.012189196	1.058526396	1.131732296	1.166141396	1.174995996	1.158099496	1.113693996	1.069204696	1.042069596	1.025689196	1.014511196	1.007649196	1.054280796	1.127727396	1.162329996	1.171336296	1.154554796	1.110232096	1.065799896	1.038699096	1.022329696	1.011141996	1.004251996	1.050839596	1.124228096	1.158760896	1.167687396	1.150816996	1.106397396	1.061858296	1.034642096	1.018152896	1.006841996	0.999825696	1.046284496	1.119542296	1.153943296	1.162736696	1.145732496	1.101178296	1.056503996	1.029152196	1.045671396	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796];																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															
        CO2RadForc	=[0	0.011049082	0.023246047	0.025605215	0.028057033	0.03055287	0.033093627	0.035705793	0.038397133	0.041160901	0.044009648	0.046979223	0.050067292	0.053202569	0.05628708	0.059234532	0.06201229	0.064664134	0.067271913	0.069921132	0.072693308	0.075631696	0.078703283	0.081821836	0.084889902	0.087836927	0.090660982	0.09339792	0.096060423	0.098642066	0.1011408	0.10356312	0.10591503	0.10819345	0.11039084	0.11250486	0.11454316	0.11651278	0.1184099	0.12022542	0.1219681	0.1236704	0.12533497	0.12690511	0.12830042	0.12946317	0.1304044	0.13119381	0.13190268	0.13259134	0.13331508	0.13409903	0.13491805	0.13571684	0.13643515	0.13702906	0.13750239	0.13789659	0.13825059	0.13859452	0.13895098	0.13932247	0.13969896	0.14007543	0.14045187	0.14082828	0.14054596	0.1385692	0.1356501	0.13282363	0.12999566	0.1271662	0.12433524	0.12244727	0.12197515	0.12197515	0.12244727	0.12386337	0.12575101	0.12810952	0.13140969	0.13470811	0.13753359	0.14082795	0.14412058	0.14694109	0.14976013	0.15210829	0.15445521	0.15727029	0.16008389	0.162896	0.16570665	0.16898372	0.17225908	0.17506481	0.17786907	0.18020493	0.18253957	0.18533992	0.18767253	0.1895378	0.19140242	0.19373219	0.19652669	0.19931973	0.2025763	0.20629582	0.21047702	0.21558294	0.22114773	0.22716948	0.23410923	0.24150205	0.24934541	0.25809794	0.26729609	0.27602009	0.28427149	0.29251018	0.29982345	0.30575788	0.31077419	0.31487495	0.31851727	0.32170241	0.32443091	0.32715801	0.32942964	0.33124617	0.33306208	0.33487737	0.33714553	0.34077243	0.34575562	0.35118677	0.35706406	0.36338651	0.36970149	0.37645901	0.38410722	0.39219378	0.3998202	0.4069878	0.41414581	0.42129426	0.42798755	0.43422682	0.44045882	0.44623943	0.45156962	0.45733777	0.46354294	0.46929869	0.47460598	0.48034937	0.48696871	0.49358042	0.49974374	0.50677828	0.51468174	0.52213573	0.52957874	0.53788518	0.54617941	0.55402496	0.56229357	0.5705501	0.57792673	0.5848599	0.59178409	0.59783591	0.60215445	0.60517523	0.60733189	0.60862547	0.60862547	0.60733189	0.60560671	0.6043125	0.60388103	0.6043125	0.60560671	0.60776302	0.6107804	0.61508782	0.62111239	0.62798987	0.63528723	0.64385931	0.65370065	0.66395102	0.67460724	0.68520067	0.69628068	0.7093687	0.72293323	0.73507442	0.74521338	0.75407365	0.76618156	0.7828982	0.79886038	0.81597004	0.83695475	0.85481939	0.86912845	0.89018132	0.91528331	0.93260715	0.94626302	0.96504571	0.9895882	1.0148272	1.0415665	1.0706749	1.0922769	1.1090268	1.131041	1.1557767	1.1790812	1.2025127	1.23094	1.2629696	1.289621	1.3103479	1.3279065	1.3409723	1.354375	1.3745818	1.400075	1.4241974	1.4491927	1.4810336	1.5106359	1.5327048	1.5559009	1.5854995	1.6175545	1.6467939	1.675125	1.7035227	1.7308597	1.7590634	1.7889061	1.8189254	1.8483587	1.8776554	1.9069846	1.9364166	1.9659683	1.995568	2.0251167	2.0545783	2.0839653	2.1132986	2.142503	2.1717034	2.2011892	2.231053	2.2613025	2.2919099	2.3227715	2.3537626	2.3848242	2.4159493	2.4471439	2.4781534	2.5088668	2.5395246	2.5702467	2.6010645	2.6319705	2.662877	2.6936716	2.7243024	2.7547673	2.7849151	2.8145156	2.8436248	2.87247	2.9011769	2.9297842	2.9582922	2.9866207	3.0146618	3.0423684	3.0693909	3.095422	3.1204161	3.1444232	3.1676809	3.1903291	3.2124211	3.2339723	3.2549163	3.2751546	3.2944862	3.3127723	3.3300499	3.3462466	3.3614003	3.3757368	3.3893909	3.4024123	3.4148148	3.4265291	3.4372972	3.4469269	3.4554329	3.4628368	3.4690594	3.4741267	3.4782569	3.4815823	3.4841511	3.4859786	3.4876965	3.4898332	3.4922482	3.4948901	3.4977254	3.5006277	3.5035829	3.5067763	3.5103153	3.5142262	3.5185	3.5230427	3.5277246	3.5324729	3.5372666	3.5421013	3.546871	3.551578	3.5564214	3.5615212	3.5666508	3.5715667	3.5762077	3.5804644	3.5842837	3.5876611	3.5906065	3.5930255	3.5949304	3.5965304	3.5980276	3.5995347	3.6010524	3.6024967	3.6037448	3.6047301	3.6054375	3.605868	3.605919	3.6055958	3.6052119	3.6049934	3.6049722	3.6051476	3.6054302	3.6056931	3.6058657	3.6059297	3.605883	3.6056196	3.6051589	3.6047192	3.6044236	3.6043129	3.6043903	3.6045701	3.6047277	3.6047946	3.6047542	3.6046058	3.6042426	3.6036662	3.6030813	3.6026139	3.6023072	3.6021664	3.602107	3.6020055	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319];

        totRadForcAerosols =	[0	-0.000675976	-0.002066998	-0.003506856	-0.004954363	-0.006391459	-0.008191986	-0.009976755	-0.011356966	-0.01270254	-0.014012763	-0.015287343	-0.016526278	-0.017729763	-0.018898132	-0.02003182	-0.021567991	-0.02307257	-0.024109188	-0.025112828	-0.026084191	-0.027023976	-0.02793288	-0.028811597	-0.029660819	-0.030481228	-0.031720164	-0.032931794	-0.033670013	-0.034381886	-0.035068072	-0.035729227	-0.036812009	-0.037870688	-0.038459809	-0.03947085	-0.040459338	-0.041867498	-0.042811099	-0.042847477	-0.04330705	-0.044187553	-0.045048591	-0.045450548	-0.045834932	-0.046202307	-0.046988661	-0.047758107	-0.04807573	-0.048378481	-0.049097878	-0.050231969	-0.051347739	-0.052018673	-0.052247777	-0.052465008	-0.052670881	-0.053287704	-0.054313124	-0.054904197	-0.055481569	-0.056048603	-0.056602739	-0.05714743	-0.057268842	-0.05983842	-0.061985112	-0.061662785	-0.062147465	-0.062625217	-0.063093126	-0.065149588	-0.066793151	-0.067226829	-0.06804864	-0.069251536	-0.070443016	-0.071619434	-0.072785088	-0.073936271	-0.076219158	-0.077724999	-0.078830357	-0.080304988	-0.081760072	-0.084206384	-0.085329759	-0.089862367	-0.094906246	-0.098208447	-0.101393282	-0.103266545	-0.105317054	-0.105997353	-0.107968928	-0.116387795	-0.128866385	-0.128795571	-0.125485166	-0.127995847	-0.132042374	-0.140424334	-0.14928997	-0.152486062	-0.151234006	-0.151466987	-0.160402206	-0.179061449	-0.1947542	-0.198352789	-0.198586719	-0.197983873	-0.193504655	-0.191345908	-0.195208839	-0.207646903	-0.215360381	-0.215031415	-0.218087204	-0.220358535	-0.218681403	-0.217795601	-0.220931602	-0.230782424	-0.235671466	-0.238864492	-0.246706766	-0.25198686	-0.255718184	-0.259476638	-0.26487402	-0.268523461	-0.269959278	-0.272220372	-0.276317622	-0.280935729	-0.285747379	-0.291266474	-0.298904499	-0.305709	-0.311545922	-0.319294997	-0.327701203	-0.329640603	-0.329068552	-0.334182054	-0.337618907	-0.338824198	-0.342313677	-0.342011793	-0.33936144	-0.342798461	-0.347957672	-0.350867581	-0.347516451	-0.347677775	-0.3454084	-0.342119065	-0.35465971	-0.364184549	-0.365854464	-0.368151399	-0.372525128	-0.377386134	-0.382166479	-0.38358385	-0.378426528	-0.372771128	-0.37227763	-0.376968865	-0.381187274	-0.385522052	-0.388809485	-0.383465723	-0.380051358	-0.386238251	-0.394132974	-0.400044909	-0.404686862	-0.411219971	-0.417808053	-0.424942444	-0.436550005	-0.451072392	-0.460730359	-0.47132463	-0.485948929	-0.499093718	-0.513493077	-0.528108546	-0.541202914	-0.554526045	-0.569111482	-0.580900275	-0.589886127	-0.599245872	-0.615326031	-0.634162267	-0.648152241	-0.661127268	-0.672664849	-0.68331011	-0.697116357	-0.710948355	-0.719077087	-0.71911438	-0.721449764	-0.736759778	-0.754362971	-0.770767926	-0.789130039	-0.80601477	-0.821191128	-0.832929705	-0.841152228	-0.85933556	-0.880228361	-0.892233563	-0.903960412	-0.913700084	-0.919932207	-0.92639676	-0.93527688	-0.94303346	-0.94762044	-0.95069843	-0.95119214	-0.9576636	-0.963458	-0.96214829	-0.95636781	-0.94950125	-0.95753327	-0.975601654	-0.989785514	-1.003405333	-1.012051132	-1.013435813	-1.015786584	-1.018599741	-1.01833266	-1.01236391	-1.003750303	-0.995114358	-0.986457113	-0.977777721	-0.969073324	-0.960346111	-0.951598327	-0.942829704	-0.934039961	-0.925228827	-0.916396014	-0.90754123	-0.898664187	-0.890292817	-0.882957433	-0.876132694	-0.869290894	-0.862431784	-0.855555154	-0.848660744	-0.841748334	-0.834817645	-0.827868445	-0.820599662	-0.812707934	-0.804490743	-0.796247711	-0.78797841	-0.779682409	-0.771359268	-0.763008527	-0.754629696	-0.746222285	-0.737474398	-0.728070979	-0.718318734	-0.708527328	-0.698695963	-0.688823798	-0.678909993	-0.668953668	-0.658953923	-0.648909818	-0.639894686	-0.63298802	-0.627122907	-0.621226513	-0.61529829	-0.609337657	-0.603344043	-0.59731684	-0.591255417	-0.585159134	-0.579277044	-0.573859554	-0.568658118	-0.563422861	-0.558153155	-0.552848369	-0.547507832	-0.542130876	-0.536716789	-0.531264873	-0.526029137	-0.52126515	-0.516719433	-0.512137017	-0.5075172	-0.502859253	-0.498162436	-0.49342597	-0.488649073	-0.483830916	-0.479956927	-0.478028281	-0.477079243	-0.476128744	-0.475176746	-0.474223267	-0.473268299	-0.47231183	-0.471353862	-0.470394373	-0.46943793	-0.468488977	-0.467542939	-0.466595231	-0.465645873	-0.464694836	-0.463742138	-0.46278773	-0.461831652	-0.460873864	-0.46015457	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596];

        
        c = 4186; % J/kgK
        rho = 1020; % kg/m³ 
        h = 50; % m
        C1 = c * h * rho * 3.16887646e-8; % W yr /m²K
        d = 2000; % m
        C2 = c * d * rho * 3.16887646e-8; % W yr /m²K
        

        p0_co2 = 0.469 * 600; % ppm CO2 / GtC
        rf = @(p_co2) 5.35 * log(p_co2 ./ p0_co2);

        RF = s(j) * totRadForcAerosols(1:length(U)) + totRadForcExclCO2AndAerosols(1:length(U)) + rf(conc);

        d_delta_T1 = @(t, delta_T) 1/C1 * (RF(t) - delta_T(1) / lambda(j) - kappa(j) * (delta_T(1) - delta_T(2)));
        d_delta_T2 = @(t, delta_T) 1/C2 * kappa(j) * (delta_T(1) - delta_T(2));
        d_delta_T = @(t, delta_T) [d_delta_T1(t, delta_T); d_delta_T2(t, delta_T)];

        delta_T = zeros(2, length(U));
        for t = 1:length(U)-1
            delta_T(:, t+1) = delta_T(:,t) + d_delta_T(t, delta_T(:,t));
        end
        
        subplot(1,3,j)
        T = (1:length(U)) + 1764; %1765:2200;
        plot(T, delta_T(1,:), 'DisplayName', ['scenario ', num2str(i)])
        title(['\lambda = ', num2str(lambda(j)), ', \kappa = ', num2str(kappa(j)), ', s = ', num2str(s(j))])
        hold on
        axis([1980 2100 0 6])
        xlabel('Year'), ylabel('Temperature deviation')
        legend('Location','northwest');
    end
end



%% del 3 upg 14
clc, clear, clf

%Parametrar
F = [0 60 0; 15 0 45; 45 0 0]; %GtC
NPP0 = F(1,2);
beta = 0.38; %Kan variera mellan 0.1 och 0.8
B0 = [600 600 1500]; %GtC
A = [0.113 0.213 0.258 0.273 0.1430];
tao_0 = [2.0 12.2 50.4 243.3 Inf];
k = 3.06*1e-3;
M0 = 600;
global CO2Emissions;
global CO2ConcRCP45;

CO2today = CO2Emissions(2021-1765);

scenario1 = [CO2Emissions(1:2021-1765-1), linspace(CO2today,0,49), zeros(1,130)];
scenario2 = [CO2Emissions(1:2021-1765-1), CO2today * ones(1,179)];
scenario3 = [CO2Emissions(1:2021-1765-1), linspace(CO2today,CO2today*1.5,79), CO2today*1.5*ones(1,100)];

CO2scenarios = [scenario1; scenario2; scenario3];

%Nettoprimärproduktion av biomassa (fotosyntes)
NPP = @(B) NPP0*(1+beta*log(B(1)/B0(1)));

%Flödeskoefficienter
alpha = @(i,j) F(i,j)/B0(i);
lambda = [0.5, 0.8, 1.3]; %0.5-1.3  m²K/W
kappa = [0.2 0.6 1]; % 0.2-1 W/m²K
s = [1, 1.2, 1.4]; 

for j = 1:3
    for i = 3:3
        U = CO2scenarios(i, :);
        % Differentialekvationer
        % B är en 1x3 vektor
        dB1 = @(B,t) alpha(3,1)*B(3) + alpha(2,1)*B(2) - NPP(B) + U(t);
        dB2 = @(B,t) NPP(B) - alpha(2,3)*B(2) - alpha(2,1)*B(2);
        dB3 = @(B,t) alpha(2,3)*B(2) - alpha(3,1)*B(3);
        dB = @(B,t) [dB1(B,t); dB2(B,t); dB3(B,t)];

        % -- lösning --
        B = zeros(3, length(U));    % 3 x 736 matris för alla B
        B(:, 1) = B0(:);    % sätt startvärden
        emissions = zeros(1, length(U));
        for t = 1:length(U)-1   % 1:735
            M = M0;
            for t_tilde = 1:t                
                I = sum(A' .* exp(-(t-t_tilde) ./ (tao_0*(1+k*emissions(t)))'));
                M = M + I * dB1(B(:, t_tilde), t_tilde);
            end

            B(:, t+1) = B(:, t) + dB(B(:, t), t);

            % kumulativa utsläpp (utan haven)
            emissions(t+1) = emissions(t) + dB1(B(:, t), t);

            % B1 med haven
            B(1, t+1) = M;
        end

        % Koncentrationerna
        conc = 0.469 * B(1,:); %ppm C02


        totRadForcExclCO2AndAerosols	= [0	0.115653444	0.251852421	0.256772281	0.21894257	0.218662979	0.259240629	0.274128052	0.263715683	0.249641179	0.238842165	0.24516418	0.272219646	0.302402384	0.310191962	0.302471248	0.293277521	0.249428376	0.132442595	0.04546089	0.115843943	0.2409541	0.302228607	0.308758611	0.195824757	0.031526544	0.049079212	0.172332524	0.23218477	0.22747827	0.190773442	0.177218677	0.192953549	0.207144648	0.213703669	0.23042582	0.251730578	0.248292338	0.232695799	0.228873797	0.22688789	0.217079623	0.207049891	-0.288063492	-1.432583888	-1.835225463	-1.039544299	-0.362618293	-0.161734092	-0.683174499	-2.146158602	-2.647045861	-1.477800511	-0.349345887	0.101159597	0.227302718	0.234152981	0.236913494	0.241604664	0.250046637	0.264208279	0.282755463	0.302280349	0.31267249	0.286334542	0.07059477	-0.321273268	-0.427595945	-0.135478426	-0.285498133	-0.886015654	-0.797080872	-0.182349169	0.193958939	0.30957468	0.290781286	0.267335976	0.267729314	0.240486098	0.234404641	0.283643618	0.334607869	0.371155547	0.398394488	0.382637532	0.342661444	0.334194749	0.338274987	0.333926336	0.325079597	0.184135622	-0.270701965	-0.504879886	-0.159822708	0.197818888	0.332032465	0.308787805	0.206705041	0.206849986	0.278889867	0.315133894	0.325931334	0.33742729	0.363518892	0.395412426	0.422015857	0.426645026	0.395538269	0.35406617	0.336504589	0.309899989	0.259123863	0.252376955	0.284053268	0.314109429	0.349503923	0.377269521	0.278831575	-0.629717546	-1.373927045	-0.800080887	-0.323770859	-0.207057768	-0.100691462	-0.167355374	-0.206323788	-0.105892434	0.09628362	0.266655774	0.386777178	0.36677811	0.196555121	0.095979808	0.190147272	0.298552342	0.344506769	0.327173489	-0.113790262	-0.474166121	-0.152451355	0.212517922	0.316817217	0.297380813	0.309295553	0.367502712	0.386955244	0.384655847	0.142469828	0.044747057	0.283698513	0.43263847	0.504926821	0.539494712	0.544118701	0.513536131	0.405936135	0.37234803	0.447712685	0.47375747	0.479011799	0.508073244	0.547260979	0.564197508	0.514129624	0.459999959	0.48207783	0.494661458	0.447371348	0.45119702	0.509172645	0.562700164	0.619237352	0.631705145	0.611896493	0.610231628	0.625996601	0.626160414	0.589091869	0.571990642	0.608405371	0.654051893	0.694977724	0.720413015	0.742174692	0.728470769	0.69787577	0.666187529	0.637413808	0.624309607	0.639054306	0.702878524	0.789673585	0.861303922	0.878147945	0.862438037	0.770080682	0.643959431	0.544238987	0.064992161	-0.278618322	0.069158369	0.49375619	0.667011447	0.504176985	0.457439657	0.71169703	0.889341414	0.944017858	0.901528461	0.753531286	0.664636749	0.81866331	1.030431828	1.093936205	1.155776228	1.25472466	1.195712861	0.497982973	0.181685802	0.709800594	0.992174407	1.06624936	1.13962008	1.25615126	1.35861424	1.38598613	0.43002636	-0.20014154	0.5062205	1.02436749	1.19750461	1.26318155	1.32400737	1.418781354	1.512371514	1.566890933	1.584131132	1.573295813	1.536130684	1.497623741	1.42695926	1.29936181	1.224840503	1.221944658	1.272839613	1.350555721	1.389231524	1.402708811	1.390630427	1.350778504	1.310808261	1.288179927	1.276313914	1.26967103	1.267795187	1.319478017	1.397457733	1.436743594	1.450574994	1.438350984	1.398344554	1.357997044	1.334769334	1.322080745	1.314395545	1.310843062	1.360610934	1.436521243	1.472789511	1.48302551	1.467023409	1.423019968	1.378434527	1.350708396	1.333247185	1.320505198	1.311604279	1.355316334	1.424985028	1.455426263	1.459961498	1.438460293	1.389217168	1.339695623	1.307369318	1.285714786	1.26925592	1.257008107	1.298085813	1.36586909	1.394717557	1.397900543	1.37524554	1.325016217	1.274657634	1.241623544	1.219327054	1.202204318	1.189352461	1.229955555	1.297340469	1.325853632	1.328751876	1.305852089	1.255408973	1.204860137	1.17165475	1.149174933	1.131847317	1.1187913	1.159193753	1.226381036	1.25469927	1.257413373	1.234409816	1.183990427	1.133570781	1.101464943	1.081181544	1.066382546	1.056155067	1.099652799	1.17017423	1.202040762	1.208483473	1.18929603	1.142711377	1.096144839	1.067025631	1.048747173	1.035751036	1.027145138	1.07210183	1.143937052	1.176987664	1.18449907	1.166279496	1.120835296	1.075637496	1.047901096	1.031012396	1.019407396	1.012189196	1.058526396	1.131732296	1.166141396	1.174995996	1.158099496	1.113693996	1.069204696	1.042069596	1.025689196	1.014511196	1.007649196	1.054280796	1.127727396	1.162329996	1.171336296	1.154554796	1.110232096	1.065799896	1.038699096	1.022329696	1.011141996	1.004251996	1.050839596	1.124228096	1.158760896	1.167687396	1.150816996	1.106397396	1.061858296	1.034642096	1.018152896	1.006841996	0.999825696	1.046284496	1.119542296	1.153943296	1.162736696	1.145732496	1.101178296	1.056503996	1.029152196	1.045671396	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796	1.072839796];																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															
        CO2RadForc	=[0	0.011049082	0.023246047	0.025605215	0.028057033	0.03055287	0.033093627	0.035705793	0.038397133	0.041160901	0.044009648	0.046979223	0.050067292	0.053202569	0.05628708	0.059234532	0.06201229	0.064664134	0.067271913	0.069921132	0.072693308	0.075631696	0.078703283	0.081821836	0.084889902	0.087836927	0.090660982	0.09339792	0.096060423	0.098642066	0.1011408	0.10356312	0.10591503	0.10819345	0.11039084	0.11250486	0.11454316	0.11651278	0.1184099	0.12022542	0.1219681	0.1236704	0.12533497	0.12690511	0.12830042	0.12946317	0.1304044	0.13119381	0.13190268	0.13259134	0.13331508	0.13409903	0.13491805	0.13571684	0.13643515	0.13702906	0.13750239	0.13789659	0.13825059	0.13859452	0.13895098	0.13932247	0.13969896	0.14007543	0.14045187	0.14082828	0.14054596	0.1385692	0.1356501	0.13282363	0.12999566	0.1271662	0.12433524	0.12244727	0.12197515	0.12197515	0.12244727	0.12386337	0.12575101	0.12810952	0.13140969	0.13470811	0.13753359	0.14082795	0.14412058	0.14694109	0.14976013	0.15210829	0.15445521	0.15727029	0.16008389	0.162896	0.16570665	0.16898372	0.17225908	0.17506481	0.17786907	0.18020493	0.18253957	0.18533992	0.18767253	0.1895378	0.19140242	0.19373219	0.19652669	0.19931973	0.2025763	0.20629582	0.21047702	0.21558294	0.22114773	0.22716948	0.23410923	0.24150205	0.24934541	0.25809794	0.26729609	0.27602009	0.28427149	0.29251018	0.29982345	0.30575788	0.31077419	0.31487495	0.31851727	0.32170241	0.32443091	0.32715801	0.32942964	0.33124617	0.33306208	0.33487737	0.33714553	0.34077243	0.34575562	0.35118677	0.35706406	0.36338651	0.36970149	0.37645901	0.38410722	0.39219378	0.3998202	0.4069878	0.41414581	0.42129426	0.42798755	0.43422682	0.44045882	0.44623943	0.45156962	0.45733777	0.46354294	0.46929869	0.47460598	0.48034937	0.48696871	0.49358042	0.49974374	0.50677828	0.51468174	0.52213573	0.52957874	0.53788518	0.54617941	0.55402496	0.56229357	0.5705501	0.57792673	0.5848599	0.59178409	0.59783591	0.60215445	0.60517523	0.60733189	0.60862547	0.60862547	0.60733189	0.60560671	0.6043125	0.60388103	0.6043125	0.60560671	0.60776302	0.6107804	0.61508782	0.62111239	0.62798987	0.63528723	0.64385931	0.65370065	0.66395102	0.67460724	0.68520067	0.69628068	0.7093687	0.72293323	0.73507442	0.74521338	0.75407365	0.76618156	0.7828982	0.79886038	0.81597004	0.83695475	0.85481939	0.86912845	0.89018132	0.91528331	0.93260715	0.94626302	0.96504571	0.9895882	1.0148272	1.0415665	1.0706749	1.0922769	1.1090268	1.131041	1.1557767	1.1790812	1.2025127	1.23094	1.2629696	1.289621	1.3103479	1.3279065	1.3409723	1.354375	1.3745818	1.400075	1.4241974	1.4491927	1.4810336	1.5106359	1.5327048	1.5559009	1.5854995	1.6175545	1.6467939	1.675125	1.7035227	1.7308597	1.7590634	1.7889061	1.8189254	1.8483587	1.8776554	1.9069846	1.9364166	1.9659683	1.995568	2.0251167	2.0545783	2.0839653	2.1132986	2.142503	2.1717034	2.2011892	2.231053	2.2613025	2.2919099	2.3227715	2.3537626	2.3848242	2.4159493	2.4471439	2.4781534	2.5088668	2.5395246	2.5702467	2.6010645	2.6319705	2.662877	2.6936716	2.7243024	2.7547673	2.7849151	2.8145156	2.8436248	2.87247	2.9011769	2.9297842	2.9582922	2.9866207	3.0146618	3.0423684	3.0693909	3.095422	3.1204161	3.1444232	3.1676809	3.1903291	3.2124211	3.2339723	3.2549163	3.2751546	3.2944862	3.3127723	3.3300499	3.3462466	3.3614003	3.3757368	3.3893909	3.4024123	3.4148148	3.4265291	3.4372972	3.4469269	3.4554329	3.4628368	3.4690594	3.4741267	3.4782569	3.4815823	3.4841511	3.4859786	3.4876965	3.4898332	3.4922482	3.4948901	3.4977254	3.5006277	3.5035829	3.5067763	3.5103153	3.5142262	3.5185	3.5230427	3.5277246	3.5324729	3.5372666	3.5421013	3.546871	3.551578	3.5564214	3.5615212	3.5666508	3.5715667	3.5762077	3.5804644	3.5842837	3.5876611	3.5906065	3.5930255	3.5949304	3.5965304	3.5980276	3.5995347	3.6010524	3.6024967	3.6037448	3.6047301	3.6054375	3.605868	3.605919	3.6055958	3.6052119	3.6049934	3.6049722	3.6051476	3.6054302	3.6056931	3.6058657	3.6059297	3.605883	3.6056196	3.6051589	3.6047192	3.6044236	3.6043129	3.6043903	3.6045701	3.6047277	3.6047946	3.6047542	3.6046058	3.6042426	3.6036662	3.6030813	3.6026139	3.6023072	3.6021664	3.602107	3.6020055	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319	3.6019319];

        totRadForcAerosols =	[0	-0.000675976	-0.002066998	-0.003506856	-0.004954363	-0.006391459	-0.008191986	-0.009976755	-0.011356966	-0.01270254	-0.014012763	-0.015287343	-0.016526278	-0.017729763	-0.018898132	-0.02003182	-0.021567991	-0.02307257	-0.024109188	-0.025112828	-0.026084191	-0.027023976	-0.02793288	-0.028811597	-0.029660819	-0.030481228	-0.031720164	-0.032931794	-0.033670013	-0.034381886	-0.035068072	-0.035729227	-0.036812009	-0.037870688	-0.038459809	-0.03947085	-0.040459338	-0.041867498	-0.042811099	-0.042847477	-0.04330705	-0.044187553	-0.045048591	-0.045450548	-0.045834932	-0.046202307	-0.046988661	-0.047758107	-0.04807573	-0.048378481	-0.049097878	-0.050231969	-0.051347739	-0.052018673	-0.052247777	-0.052465008	-0.052670881	-0.053287704	-0.054313124	-0.054904197	-0.055481569	-0.056048603	-0.056602739	-0.05714743	-0.057268842	-0.05983842	-0.061985112	-0.061662785	-0.062147465	-0.062625217	-0.063093126	-0.065149588	-0.066793151	-0.067226829	-0.06804864	-0.069251536	-0.070443016	-0.071619434	-0.072785088	-0.073936271	-0.076219158	-0.077724999	-0.078830357	-0.080304988	-0.081760072	-0.084206384	-0.085329759	-0.089862367	-0.094906246	-0.098208447	-0.101393282	-0.103266545	-0.105317054	-0.105997353	-0.107968928	-0.116387795	-0.128866385	-0.128795571	-0.125485166	-0.127995847	-0.132042374	-0.140424334	-0.14928997	-0.152486062	-0.151234006	-0.151466987	-0.160402206	-0.179061449	-0.1947542	-0.198352789	-0.198586719	-0.197983873	-0.193504655	-0.191345908	-0.195208839	-0.207646903	-0.215360381	-0.215031415	-0.218087204	-0.220358535	-0.218681403	-0.217795601	-0.220931602	-0.230782424	-0.235671466	-0.238864492	-0.246706766	-0.25198686	-0.255718184	-0.259476638	-0.26487402	-0.268523461	-0.269959278	-0.272220372	-0.276317622	-0.280935729	-0.285747379	-0.291266474	-0.298904499	-0.305709	-0.311545922	-0.319294997	-0.327701203	-0.329640603	-0.329068552	-0.334182054	-0.337618907	-0.338824198	-0.342313677	-0.342011793	-0.33936144	-0.342798461	-0.347957672	-0.350867581	-0.347516451	-0.347677775	-0.3454084	-0.342119065	-0.35465971	-0.364184549	-0.365854464	-0.368151399	-0.372525128	-0.377386134	-0.382166479	-0.38358385	-0.378426528	-0.372771128	-0.37227763	-0.376968865	-0.381187274	-0.385522052	-0.388809485	-0.383465723	-0.380051358	-0.386238251	-0.394132974	-0.400044909	-0.404686862	-0.411219971	-0.417808053	-0.424942444	-0.436550005	-0.451072392	-0.460730359	-0.47132463	-0.485948929	-0.499093718	-0.513493077	-0.528108546	-0.541202914	-0.554526045	-0.569111482	-0.580900275	-0.589886127	-0.599245872	-0.615326031	-0.634162267	-0.648152241	-0.661127268	-0.672664849	-0.68331011	-0.697116357	-0.710948355	-0.719077087	-0.71911438	-0.721449764	-0.736759778	-0.754362971	-0.770767926	-0.789130039	-0.80601477	-0.821191128	-0.832929705	-0.841152228	-0.85933556	-0.880228361	-0.892233563	-0.903960412	-0.913700084	-0.919932207	-0.92639676	-0.93527688	-0.94303346	-0.94762044	-0.95069843	-0.95119214	-0.9576636	-0.963458	-0.96214829	-0.95636781	-0.94950125	-0.95753327	-0.975601654	-0.989785514	-1.003405333	-1.012051132	-1.013435813	-1.015786584	-1.018599741	-1.01833266	-1.01236391	-1.003750303	-0.995114358	-0.986457113	-0.977777721	-0.969073324	-0.960346111	-0.951598327	-0.942829704	-0.934039961	-0.925228827	-0.916396014	-0.90754123	-0.898664187	-0.890292817	-0.882957433	-0.876132694	-0.869290894	-0.862431784	-0.855555154	-0.848660744	-0.841748334	-0.834817645	-0.827868445	-0.820599662	-0.812707934	-0.804490743	-0.796247711	-0.78797841	-0.779682409	-0.771359268	-0.763008527	-0.754629696	-0.746222285	-0.737474398	-0.728070979	-0.718318734	-0.708527328	-0.698695963	-0.688823798	-0.678909993	-0.668953668	-0.658953923	-0.648909818	-0.639894686	-0.63298802	-0.627122907	-0.621226513	-0.61529829	-0.609337657	-0.603344043	-0.59731684	-0.591255417	-0.585159134	-0.579277044	-0.573859554	-0.568658118	-0.563422861	-0.558153155	-0.552848369	-0.547507832	-0.542130876	-0.536716789	-0.531264873	-0.526029137	-0.52126515	-0.516719433	-0.512137017	-0.5075172	-0.502859253	-0.498162436	-0.49342597	-0.488649073	-0.483830916	-0.479956927	-0.478028281	-0.477079243	-0.476128744	-0.475176746	-0.474223267	-0.473268299	-0.47231183	-0.471353862	-0.470394373	-0.46943793	-0.468488977	-0.467542939	-0.466595231	-0.465645873	-0.464694836	-0.463742138	-0.46278773	-0.461831652	-0.460873864	-0.46015457	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596	-0.459914596];

        
        c = 4186; % J/kgK
        rho = 1020; % kg/m³ 
        h = 50; % m
        C1 = c * h * rho * 3.16887646e-8; % W yr /m²K
        d = 2000; % m
        C2 = c * d * rho * 3.16887646e-8; % W yr /m²K
        

        p0_co2 = 0.469 * 600; % ppm CO2 / GtC
        rf = @(p_co2) 5.35 * log(p_co2 ./ p0_co2);

        RF = s(j) * totRadForcAerosols(1:length(U)) + totRadForcExclCO2AndAerosols(1:length(U)) + rf(conc);
        
        
        sunscreen = [zeros(1, 2050-1765-1), 4*ones(1,51), zeros(1, 100)];
        d_delta_T1 = @(t, delta_T) 1/C1 * (RF(t) -sunscreen(t) - delta_T(1) / lambda(j) - kappa(j) * (delta_T(1) - delta_T(2)));
        d_delta_T2 = @(t, delta_T) 1/C2 * kappa(j) * (delta_T(1) - delta_T(2));
        d_delta_T = @(t, delta_T) [d_delta_T1(t, delta_T); d_delta_T2(t, delta_T)];

        delta_T = zeros(2, length(U));
        for t = 1:length(U)-1
            delta_T(:, t+1) = delta_T(:,t) + d_delta_T(t, delta_T(:,t));
        end
        
        subplot(1,3,j)
        T = (1:length(U)) + 1764; %1765:2200;
        plot(T, delta_T(1,:), 'DisplayName', ['scenario ', num2str(i)])
        title(['\lambda = ', num2str(lambda(j))])
        hold on
        axis([1980, 2200, 0, 5])
        xlabel('Year'), ylabel('Temperature deviation')
        legend('Location','northwest');
    end
end

sgtitle('Scenario 3 with geoengineering')










